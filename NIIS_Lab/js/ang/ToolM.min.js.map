{"version":3,"sources":["ToolM.src.js"],"names":["angular","module","directive","scope","element","attrs","$last","$eval","repeatCallback","$parent","provider","this","$get","self","doPOST","url","obj","form","document","createElement","setAttribute","key","addInput","body","appendChild","submit","value","hf","hf2","querySelector","popUpWindow","title","w","h","left","screen","width","top","height","window","open","openWindowWithPost","newWindow","html","write","popPrint","data","cssAry","mywindow","i","length","innerHTML","setTimeout","close","focus","print","setData","location","hash","encodeURIComponent","JSON","stringify","ex","getData","parse","decodeURIComponent","substring"],"mappings":";;AAAAA,QAAQC,OAAO,YACdC,UAAU,iBAAkB,WACzB,MAAO,UAAUC,EAAOC,EAASC,GAEjBF,EAAMG,OACNH,EAAMI,MAAMF,EAAMG,gBAGnBL,EAAMM,SAEDN,EAAMM,QAAQH,OACdH,EAAMI,MAAMF,EAAMG,mBAKzCE,SAAS,eAAgB,WAClBC,KAAKC,KAAO,WACR,GAAIC,GAAOF,IAuGX,OArGAE,GAAKC,OAAS,SAAUC,EAAKC,EAAKZ,GAC9B,GAAIa,GAAOC,SAASC,cAAc,OAC9Bf,KACAa,EAAOb,GAEXa,EAAKG,aAAa,SAAU,QAC5BH,EAAKG,aAAa,SAAUL,GAC5BE,EAAKG,aAAa,QAAS,gBAE3B,KAAK,GAAIC,KAAOL,GACZH,EAAKS,SAASD,EAAKL,EAAIK,GAAMJ,EAG5Bb,IACDc,SAASK,KAAKC,YAAYP,GAG9BA,EAAKQ,UAGTZ,EAAKS,SAAW,SAAUD,EAAKK,EAAOtB,GAClC,GAAIuB,GAAKT,SAASC,cAAc,SAC5BS,EAAMV,SAASW,cAAc,eAAiBR,EAAM,KACpDO,KAEAD,EAAKC,GAETD,EAAGP,aAAa,OAAQ,UACxBO,EAAGP,aAAa,OAAQC,GACxBM,EAAGP,aAAa,QAASM,GACpBE,GACDxB,EAAQoB,YAAYG,IAK5Bd,EAAKiB,YAAc,SAAUf,EAAKgB,EAAOC,EAAGC,GACxC,GAAIC,GAAQC,OAAOC,MAAQ,EAAMJ,EAAI,EACjCK,EAAOF,OAAOG,OAAS,EAAML,EAAI,CACrC,OAAOM,QAAOC,KAAKzB,EAAKgB,EAAO,qIAAuIC,EAAI,YAAcC,EAAI,SAAWI,EAAM,UAAYH,IAG7NrB,EAAK4B,mBAAqB,SAAU1B,EAAKgB,EAAOC,EAAGC,EAAGjB,GAClD,GAAI0B,GAAY7B,EAAKiB,YAAYf,EAAKgB,EAAOC,EAAGC,EAChD,KAAKS,EAAW,OAAO,CACvB,IAAIC,GAAO,EACXA,IAAQ,oEAAsE5B,EAAM,uBACpF,KAAK,GAAIM,KAAOL,GACZ2B,GAAQ,8BAAgCtB,EAAM,YAAcL,EAAIK,GAAO,KAI3E,OAFAsB,IAAQ,oFACRD,EAAUxB,SAAS0B,MAAMD,GAClBD,GAGX7B,EAAKgC,SAAW,SAAUC,EAAMC,GAC5BA,EAASA,KACT,IAAIC,GAAWnC,EAAKiB,YAAY,GAAI,QAAS,IAAK,IAElDkB,GAAS9B,SAAS0B,MAAM,gCAGxB,KAAK,GAAIK,GAAI,EAAGA,EAAIF,EAAOG,OAAQD,IAC/BD,EAAS9B,SAAS0B,MAAM,gCAAkCG,EAAOE,GAAK,uBAe1E,OAbAD,GAAS9B,SAAS0B,MAAM,gCACxBI,EAAS9B,SAASK,KAAK4B,UAAY,GACnCH,EAAS9B,SAAS0B,MAAME,GACxBE,EAAS9B,SAAS0B,MAAM,kBAExBQ,WAAW,WACPlC,SAASmC,QACTL,EAASM,QAETN,EAASO,QACTP,EAASK,SACV,MAEI,GAGXxC,EAAK2C,QAAU,SAAUV,GACrB,IAEIW,SAASC,KAAOC,mBAAmBC,KAAKC,UAAUf,IAEtD,MAAMgB,MAMVjD,EAAKkD,QAAU,WACX,IACI,MAAOH,MAAKI,MAAMC,mBAAmBR,SAASC,KAAKQ,UAAU,KAEjE,MAAOJ,GACH,MAAO,KAIRjD","file":"ToolM.min.js","sourcesContent":["angular.module(\"ToolM\", [])\r\n.directive('repeatCallback', function () {\r\n    return function (scope, element, attrs) {\r\n                //console.log(999);\r\n                if (scope.$last) {\r\n                    scope.$eval(attrs.repeatCallback);\r\n                }\r\n\r\n                if(scope.$parent)\r\n                {\r\n                    if (scope.$parent.$last) {\r\n                        scope.$eval(attrs.repeatCallback);\r\n                    }\r\n                }\r\n           };\r\n})\r\n.provider(\"ToolProvider\", function () {\r\n        this.$get = function () {\r\n            var self = this;\r\n            // 利用post 到某頁面\r\n            self.doPOST = function (url, obj, element) {\r\n                var form = document.createElement(\"form\");\r\n                if (element) {\r\n                    form = element;\r\n                }\r\n                form.setAttribute(\"method\", \"post\");\r\n                form.setAttribute(\"action\", url);\r\n                form.setAttribute(\"style\", \"display:none;\");\r\n\r\n                for (var key in obj) {\r\n                    self.addInput(key, obj[key], form);\r\n                }\r\n\r\n                if (!element) {\r\n                    document.body.appendChild(form);\r\n                }\r\n\r\n                form.submit();\r\n            }\r\n\r\n            self.addInput = function (key, value, element) {\r\n                var hf = document.createElement(\"input\");\r\n                var hf2 = document.querySelector(\"input[name='\" + key + \"']\");\r\n                if (hf2)\r\n                {\r\n                    hf = hf2;\r\n                }\r\n                hf.setAttribute(\"type\", \"hidden\");\r\n                hf.setAttribute(\"name\", key);\r\n                hf.setAttribute(\"value\", value);\r\n                if (!hf2) {\r\n                    element.appendChild(hf);\r\n                }\r\n               \r\n            }\r\n\r\n            self.popUpWindow = function (url, title, w, h) {\r\n                var left = (screen.width / 2) - (w / 2);\r\n                var top = (screen.height / 2) - (h / 2);\r\n                return window.open(url, title, 'toolbar=no, location=no,scrollbars=yes, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);\r\n            }\r\n\r\n            self.openWindowWithPost = function (url, title, w, h, obj) {\r\n                var newWindow = self.popUpWindow(url, title, w, h);\r\n                if (!newWindow) return false;\r\n                var html = \"\";\r\n                html += \"<html><head></head><body><form id='formid' method='post' action='\" + url + \"' autocomplete='off'>\";\r\n                for (var key in obj) {\r\n                    html += \"<input type='hidden' name='\" + key + \"' value='\" + obj[key] + \"'/>\";\r\n                }\r\n                html += \"</form><script>document.getElementById('formid').submit();\" + \"</\" + \"script\" + \"></\" + \"body\" + \"></\" + \"html>\";\r\n                newWindow.document.write(html);\r\n                return newWindow;\r\n            }\r\n\r\n            self.popPrint = function (data, cssAry) {\r\n                cssAry = cssAry || [];\r\n                var mywindow = self.popUpWindow(\"\", \"Print\", 800, 600);\r\n\r\n                mywindow.document.write('<html><head><title>列印</title>');\r\n                /*optional stylesheet*/\r\n\r\n                for (var i = 0; i < cssAry.length; i++) {\r\n                    mywindow.document.write('<link rel=\"stylesheet\" href=\"' + cssAry[i] + '\" type=\"text/css\" />');\r\n                }\r\n                mywindow.document.write('</head><body class=\"bodybg\">');\r\n                mywindow.document.body.innerHTML = '';\r\n                mywindow.document.write(data);\r\n                mywindow.document.write('</body></html>');\r\n\r\n                setTimeout(function () {\r\n                    document.close(); // necessary for IE >= 10\r\n                    mywindow.focus(); // necessary for IE >= 10\r\n\r\n                    mywindow.print();\r\n                    mywindow.close();\r\n                }, 500);\r\n\r\n                return true;\r\n            };\r\n\r\n            self.setData = function (data) {\r\n                try\r\n                {\r\n                    location.hash = encodeURIComponent(JSON.stringify(data));\r\n                }\r\n                catch(ex)\r\n                {\r\n\r\n                }\r\n            };\r\n\r\n            self.getData = function () {\r\n                try {\r\n                    return JSON.parse(decodeURIComponent(location.hash.substring(1)));\r\n                }\r\n                catch (ex) {\r\n                    return \"\";\r\n                }\r\n            };\r\n\r\n            return self;\r\n\r\n\r\n        };\r\n});\r\n\r\n"]}