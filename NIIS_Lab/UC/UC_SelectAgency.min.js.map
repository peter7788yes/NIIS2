{"version":3,"sources":["UC_SelectAgency.src.js"],"names":["$","window","addEventListener","currentState","history","state","controllerElement","document","querySelector","controllerScope","angular","element","scope","$apply","changePage","pageIndex","location","search","length","setTimeout","go","module","controller","$scope","PageProvider","$http","hotkeys","PM","TM","VM","Vaccine","VaccineIDs","AN","CountyAry","I","N","SelectCounty","TownAry","SelectTown","BindCounty","postData","OrgID","method","url","data","param","headers","Content-Type","success","status","config","toString","SelectDefaultCounty","concat","error","county","ajax","cache","type","done","fail","jqXHR","textStatus","SelectCountyChange","val","SelectVillage","show","tbData","message","replaceState","title","href","pgData","genPageData","p","agencyState","hasFilter","filterPageData","pushState","undefined","noHistory","hash","split","add","combo","description","allowIn","callback","event","hotkey","focusType","activeElement","close","record","rtn","opener","getAgencyUC"],"mappings":"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","file":"UC_SelectAgency.min.js","sourcesContent":["$(function () {\r\n    window.addEventListener(\"popstate\", function () {\r\n        var currentState = history.state;\r\n        if (currentState != null) {\r\n            var controllerElement = document.querySelector('section');\r\n            var controllerScope = angular.element(controllerElement).scope();\r\n            controllerScope.$apply(function () {\r\n                controllerScope.changePage(currentState.pageIndex, 1);\r\n            });\r\n        }\r\n    });\r\n\r\n    if (location.search.length > 0) {\r\n        setTimeout(function () {\r\n            history.go(-1);\r\n        }, 10);\r\n    }\r\n});\r\n\r\nangular.module(\"MyApp\", [\"PageM\", \"cfp.hotkeys\"])\r\n         .controller(\"MyController\", [\"$scope\", \"PageProvider\", \"$http\", \"hotkeys\", function ($scope, PageProvider, $http, hotkeys) {\r\n\r\n             $scope.PM = PageProvider;\r\n             $scope.TM = {};\r\n             $scope.VM = {};\r\n             $scope.VM.Vaccine = \"\";\r\n             $scope.VM.VaccineIDs = \"\";\r\n             $scope.VM.AN = \"\";\r\n\r\n             $scope.VM.CountyAry = [{ I: \"0\", N: \"全部縣市\" }];\r\n             $scope.VM.SelectCounty = \"0\";\r\n\r\n             $scope.VM.TownAry = [{ I: \"0\", N: \"全部鄉鎮市區\" }];\r\n             $scope.VM.SelectTown = \"0\";\r\n\r\n\r\n             $scope.BindCounty = function () {\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"County\";\r\n                 postData[\"o\"] = OrgID;\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                .success(function (data, status, headers, config) {\r\n                    data = data || [];\r\n                    if (data.length == 1) {\r\n                        $scope.VM.CountyAry = data;\r\n                        $scope.VM.SelectCounty = data[0].I.toString();\r\n                        $scope.SelectDefaultCounty(data[0].I.toString());\r\n                    }\r\n                    else if (data.length > 1) {\r\n                        $scope.VM.CountyAry = [{ I: \"0\", N: \"全部縣市\" }].concat(data);\r\n                        $scope.VM.SelectCounty = \"0\";\r\n                    }\r\n                    else {\r\n                        $scope.VM.CountyAry = [{ I: \"-1\", N: \"無可選縣市\" }].concat(data);\r\n                        $scope.VM.SelectCounty = \"-1\";\r\n                    }\r\n                })\r\n                .error(function (data, status, headers, config) {\r\n                    // called asynchronously if an error occurs\r\n                    // or server returns response with an error status.\r\n                });\r\n             };\r\n\r\n             $scope.SelectDefaultCounty = function (county) {\r\n\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"Town\";\r\n                 postData[\"p\"] = county;\r\n                 postData[\"o\"] = OrgID;\r\n                 $.ajax({\r\n                     cache: false,\r\n                     type: \"POST\",\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: postData\r\n                 })\r\n                    .done(function (data) {\r\n                        data = data || [];\r\n                        setTimeout(function () {\r\n                            $scope.$apply(function () {\r\n                                if (data.length == 1) {\r\n                                    $scope.VM.TownAry = data;\r\n                                    $scope.VM.SelectTown = data[0].I.toString();\r\n                                }\r\n                                else if (data.length > 1) {\r\n                                    $scope.VM.TownAry = [{ I: \"0\", N: \"全部鄉鎮市區\" }].concat(data);\r\n                                    $scope.VM.SelectTown = \"0\";\r\n                                }\r\n                            });\r\n                        }, 1);\r\n\r\n\r\n\r\n                    })\r\n                    .fail(function (jqXHR, textStatus) {\r\n\r\n                    });\r\n\r\n             };\r\n\r\n             $scope.BindCounty();\r\n\r\n             $scope.SelectCountyChange = function () {\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"Town\";\r\n                 postData[\"p\"] = $(\"#SelectCounty\").val();\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                .success(function (data, status, headers, config) {\r\n                    data = data || [];\r\n                    if (data.length > 0) {\r\n                        $scope.VM.TownAry = [{ I: \"0\", N: \"全部鄉鎮市區\" }].concat(data);\r\n                    }\r\n                    else {\r\n                        $scope.VM.TownAry = [{ I: \"0\", N: \"全部鄉鎮市區\" }];\r\n                    }\r\n                    $scope.VM.SelectTown = \"0\";\r\n                    $scope.VM.SelectVillage = \"0\";\r\n                })\r\n                .error(function (data, status, headers, config) {\r\n                    // called asynchronously if an error occurs\r\n                    // or server returns response with an error status.\r\n                });\r\n             };\r\n\r\n             $(\"#tmBlock\").show();\r\n             $scope.PM.changePage(\"\", tbData, function (data) {\r\n                 $scope.TM.data = data.message;\r\n                 history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n             });\r\n             //$scope.changePage(1);\r\n             $scope.changePage = function (pageIndex) {\r\n                 //$(\"#pmBlock\").show();\r\n                 //$(\"#tmBlock\").show();\r\n\r\n                 var pgData = $scope.PM.genPageData(pageIndex);\r\n                 var postData = {};\r\n\r\n                 var postData = {};\r\n                 postData[\"an\"] = $scope.VM.AN;\r\n                 postData[\"ac\"] = $scope.VM.SelectCounty;\r\n                 postData[\"at\"] = $scope.VM.SelectTown;\r\n                 postData[\"p\"] = p;\r\n                 postData[\"as\"] = agencyState;\r\n                 postData[\"hf\"] = hasFilter;\r\n                 //postData[\"addlv4\"] = AddOrgLevel4;\r\n\r\n                 postData = $scope.PM.filterPageData(pgData, postData);\r\n\r\n                 $scope.PM.changePage(\"/UC/UC_SelectAgencyOP.aspx\", postData, function (data) {\r\n                     $scope.TM.data = data.message;\r\n                     $scope.$apply(function () { });\r\n\r\n                     if (history.pushState && noHistory == undefined) {\r\n                         if (pageIndex > 1 || location.hash.length > 0) {\r\n                             history.pushState({ \"pageIndex\": pageIndex }, document.title, location.href.split(\"?\")[0] + \"?#h\");\r\n                         }\r\n                         else {\r\n                             history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n                         }\r\n                     }\r\n                 });\r\n\r\n             };\r\n\r\n             hotkeys.add({\r\n                 combo: 'enter',\r\n                 description: 'Description goes here',\r\n                 allowIn: ['INPUT', \"BUTTON\", 'SELECT', 'TEXTAREA'],\r\n                 callback: function (event, hotkey) {\r\n                     var focusType = document.activeElement.type;\r\n                     if (focusType == \"text\" || focusType == \"select-one\") {\r\n                         $scope.changePage(1);\r\n                     }\r\n                 }\r\n             });\r\n\r\n\r\n             $scope.close = function (record) {\r\n                 var rtn = {};\r\n                 rtn[\"I\"] = record.I;\r\n                 rtn[\"AN\"] = record.AN;\r\n                 window.opener.getAgencyUC(rtn);\r\n                 window.close();\r\n             };\r\n\r\n             var popUpWindow = function (url, title, w, h) {\r\n                 var left = (screen.width / 2) - (w / 2);\r\n                 var top = (screen.height / 2) - (h / 2);\r\n                 return window.open(url, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);\r\n             }\r\n         }]);\r\n\r\n\r\n"]}