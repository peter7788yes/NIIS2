{"version":3,"sources":["ApplyRecord_SelectAgency.src.js"],"names":["$","document","on","e","window","close","preventDefault","addEventListener","currentState","history","state","controllerElement","querySelector","controllerScope","angular","element","scope","$apply","changePage","pageIndex","location","search","length","setTimeout","go","module","controller","$scope","PageProvider","$http","hotkeys","PM","TM","VM","Vaccine","VaccineIDs","AN","CountyAry","I","N","TownAry","SelectCounty","SelectTown","BindCounty","postData","method","url","data","param","headers","Content-Type","success","status","config","concat","error","SelectCountyChange","val","show","pgData","genPageData","filterPageData","message","pushState","undefined","noHistory","hash","title","href","split","replaceState","add","combo","description","allowIn","callback","event","hotkey","focusType","activeElement","type","record","rtn","opener","getAgency"],"mappings":"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","file":"ApplyRecord_SelectAgency.min.js","sourcesContent":["$(function () {\r\n\r\n    $(document).on(\"click\", \"#cancelBtn\", function (e) {\r\n        window.close();\r\n        e.preventDefault();\r\n        return false;\r\n    });\r\n\r\n    window.addEventListener(\"popstate\", function () {\r\n        var currentState = history.state;\r\n        if (currentState != null) {\r\n            var controllerElement = document.querySelector('section');\r\n            var controllerScope = angular.element(controllerElement).scope();\r\n            controllerScope.$apply(function () {\r\n                controllerScope.changePage(currentState.pageIndex, 1);\r\n            });\r\n        }\r\n    });\r\n\r\n    if (location.search.length > 0) {\r\n        setTimeout(function () {\r\n            history.go(-1);\r\n        }, 10);\r\n    }\r\n});\r\n\r\nangular.module(\"MyApp\", [\"PageM\", \"cfp.hotkeys\"])\r\n         .controller(\"MyController\", [\"$scope\", \"PageProvider\", \"$http\", \"hotkeys\", function ($scope, PageProvider, $http, hotkeys) {\r\n\r\n             $scope.PM = PageProvider;\r\n             $scope.TM = {};\r\n             $scope.VM = {};\r\n             $scope.VM.Vaccine = \"\";\r\n             $scope.VM.VaccineIDs = \"\";\r\n             $scope.VM.AN = \"\";\r\n\r\n             $scope.VM.CountyAry = [{ I: '0', N: \"全部\" }];\r\n             $scope.VM.TownAry = [{ I: '0', N: \"全部\" }];\r\n\r\n             $scope.VM.SelectCounty = \"0\";\r\n             $scope.VM.SelectTown = \"0\";\r\n\r\n\r\n             $scope.BindCounty = function () {\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"County\";\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                .success(function (data, status, headers, config) {\r\n                    data = data || [];\r\n                    if (data.length > 0) {\r\n                        $scope.VM.CountyAry = [].concat(data);\r\n                        $scope.VM.SelectCounty = \"0\";\r\n                    }\r\n                    else {\r\n                        $scope.VM.CountyAry = [];\r\n                        $scope.VM.SelectCounty = \"0\";\r\n                    }\r\n                })\r\n                .error(function (data, status, headers, config) {\r\n                });\r\n             };\r\n\r\n             $scope.BindCounty();\r\n\r\n             $scope.SelectCountyChange = function () {\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"Town\";\r\n                 postData[\"p\"] = $(\"#SelectCounty\").val();\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                .success(function (data, status, headers, config) {\r\n                    data = data || [];\r\n                    if (data.length > 0) {\r\n                        $scope.VM.TownAry = [].concat(data);;\r\n                        $scope.VM.SelectTown = \"0\";\r\n                    }\r\n                    else {\r\n                        $scope.VM.TownAry = [];\r\n                        $scope.VM.SelectTown = \"0\";\r\n                    }\r\n                })\r\n                .error(function (data, status, headers, config) {\r\n                });\r\n             };\r\n\r\n             //$(\"#tmBlock\").show();\r\n             //$scope.PM.changePage(\"\", tbData, function (data) {\r\n             //    $scope.TM.data = data.message;\r\n             //    //history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n             //});\r\n             //$scope.changePage(1);\r\n             $scope.changePage = function (pageIndex) {\r\n                 //$(\"#pmBlock\").show();\r\n                 $(\"#tmBlock\").show();\r\n\r\n                 var pgData = $scope.PM.genPageData(pageIndex);\r\n                 var postData = {};\r\n\r\n                 var postData = {};\r\n                 postData[\"an\"] = $scope.VM.AN;\r\n                 postData[\"ac\"] = $scope.VM.SelectCounty;\r\n                 postData[\"at\"] = $scope.VM.SelectTown;\r\n\r\n                 postData = $scope.PM.filterPageData(pgData, postData);\r\n\r\n                 $scope.PM.changePage(\"/Vaccination/RecordM/ApplyRecord_SelectAgencyOP.aspx\", postData, function (data) {\r\n                     $scope.TM.data = data.message;\r\n                     $scope.$apply(function () { });\r\n\r\n                     if (history.pushState && noHistory == undefined) {\r\n                         if (pageIndex > 1 || location.hash.length > 0) {\r\n                             history.pushState({ \"pageIndex\": pageIndex }, document.title, location.href.split(\"?\")[0] + \"?#h\");\r\n                         }\r\n                         else {\r\n                             history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n                         }\r\n                     }\r\n                 });\r\n\r\n             };\r\n\r\n             $scope.changePage(1);\r\n\r\n             hotkeys.add({\r\n                 combo: 'enter',\r\n                 description: 'Description goes here',\r\n                 allowIn: ['INPUT', \"BUTTON\", 'SELECT', 'TEXTAREA'],\r\n                 callback: function (event, hotkey) {\r\n                     var focusType = document.activeElement.type;\r\n                     if (focusType == \"text\" || focusType == \"select-one\") {\r\n                         $scope.changePage(1);\r\n                     }\r\n                 }\r\n             });\r\n\r\n             //$scope.changePage(1);\r\n\r\n\r\n             $scope.close = function (record) {\r\n                 var rtn = {};\r\n                 rtn[\"I\"] = record.I;\r\n                 rtn[\"AN\"] = record.AN;\r\n                 window.opener.getAgency(rtn);\r\n                 window.close();\r\n             };\r\n\r\n         }]);\r\n\r\n\r\n"]}