{"version":3,"sources":["DocumentViewDownload.src.js"],"names":["$","document","on","e","history","pushState","title","location","href","split","preventDefault","window","addEventListener","currentState","state","controllerElement","querySelector","controllerScope","angular","element","scope","$apply","changePage","pageIndex","search","length","setTimeout","go","module","controller","$scope","PageProvider","TPM","hotkeys","PM","TM","VM","publishState","noHistory","show","pgData","genPageData","postData","d","p","filterPageData","data","message","undefined","hash","replaceState","add","combo","description","allowIn","callback","event","hotkey","focusType","activeElement","type","name","goDetail","record","obj","doPOST"],"mappings":";;AAAAA,EAAE,WACEA,EAAEC,UAAUC,GAAG,QAAS,UAAW,SAAUC,GAMzC,MAJIC,SAAQC,WACRD,QAAQC,UAAU,KAAMJ,SAASK,MAAOC,SAASC,KAAKC,MAAM,KAAK,GAAK,QAE1EN,EAAEO,kBACK,IAGXC,OAAOC,iBAAiB,WAAY,WAChC,GAAIC,GAAeT,QAAQU,KAC3B,IAAoB,MAAhBD,EAAsB,CACtB,GAAIE,GAAoBd,SAASe,cAAc,WAC3CC,EAAkBC,QAAQC,QAAQJ,GAAmBK,OACzDH,GAAgBI,OAAO,WACfJ,EAAgBK,WAAWT,EAAaU,UAAW,QAK/DhB,SAASiB,OAAOC,OAAS,GACzBC,WAAW,WACPtB,QAAQuB,GAAG,KACZ,MAIXT,QAAQU,OAAO,SAAU,QAAQ,UAAU,QAAS,gBAC1CC,WAAW,gBAAiB,SAAU,eAAgB,eAAgB,UAAW,SAAUC,EAAQC,EAAaC,EAAKC,GAElHH,EAAOI,GAAKH,EACZD,EAAOK,MAEPL,EAAOM,MACPN,EAAOM,GAAG9B,MAAQ,GAClBwB,EAAOM,GAAGC,aAAe,IASzBP,EAAOR,WAAa,SAAUC,EAAWe,GACrCtC,EAAE,YAAYuC,MACd,IAAIC,GAASV,EAAOI,GAAGO,YAAYlB,GAC/BmB,IACJA,GAASC,EAAIb,EAAOM,GAAG9B,MACvBoC,EAASE,EAAId,EAAOM,GAAGC,aACvBK,EAAWZ,EAAOI,GAAGW,eAAeL,EAAQE,GAC5CZ,EAAOI,GAAGZ,WAAW,gDAAiDoB,EAAU,SAAUI,GAKtFhB,EAAOK,GAAGW,KAAOA,EAAKC,QACtBjB,EAAOT,OAAO,cAEVjB,QAAQC,WAA0B2C,QAAbV,IACjBf,EAAY,GAAKhB,SAAS0C,KAAKxB,OAAS,EACxCrB,QAAQC,WAAYkB,UAAaA,GAAatB,SAASK,MAAOC,SAASC,KAAKC,MAAM,KAAK,GAAK,OAG5FL,QAAQ8C,cAAe3B,UAAa,GAAKtB,SAASK,MAAOC,SAASC,UAMlFsB,EAAOR,WAAW,GAElBW,EAAQkB,KACJC,MAAO,QACPC,YAAa,wBACbC,SAAU,QAAQ,SAAU,SAAU,YACtCC,SAAU,SAAUC,EAAOC,GACvB,GAAIC,GAAYzD,SAAS0D,cAAcC,MACtB,QAAbF,GAAoC,cAAbA,GAA2C,UAAbA,GAAwD,aAA/BzD,SAAS0D,cAAcE,OAErG/B,EAAOR,WAAW,MAO9BQ,EAAOgC,SAAW,SAAUC,GACxB,GAAIC,KACJA,GAAO,EAAID,EAAU,EACrB/B,EAAIiC,OAAO,qDAAsDD,EAAK/D,SAASe,cAAc","file":"DocumentViewDownload.min.js","sourcesContent":["$(function () {\r\n    $(document).on(\"click\", \"#addBtn\", function (e) {\r\n        //location.href = \"/System/DocumentM/DocumentMaintain_Add.aspx\";\r\n        if (history.pushState) {\r\n            history.pushState(null, document.title, location.href.split(\"?\")[0] + \"?b=1\");\r\n        }\r\n        e.preventDefault();\r\n        return false;\r\n    });\r\n\r\n    window.addEventListener(\"popstate\", function () {\r\n        var currentState = history.state;\r\n        if (currentState != null) {\r\n            var controllerElement = document.querySelector('section');\r\n            var controllerScope = angular.element(controllerElement).scope();\r\n            controllerScope.$apply(function () {\r\n                    controllerScope.changePage(currentState.pageIndex, 1);\r\n            });\r\n        }\r\n    });\r\n\r\n    if (location.search.length > 0) {\r\n        setTimeout(function () {\r\n            history.go(-1);\r\n        }, 10);\r\n    }\r\n});\r\n\r\nangular.module(\"MyApp\", [\"PageM\",\"FilterM\",\"ToolM\", 'cfp.hotkeys'])\r\n         .controller(\"MyController\", [\"$scope\", \"PageProvider\", \"ToolProvider\", \"hotkeys\", function ($scope, PageProvider,TPM, hotkeys) {\r\n             \r\n             $scope.PM = PageProvider;\r\n             $scope.TM = {};\r\n             //$scope.TM.isHide = true;\r\n             $scope.VM = {};\r\n             $scope.VM.title = \"\";\r\n             $scope.VM.publishState = \"0\";\r\n\r\n             //$(\"#tmBlock\").show();\r\n             //$scope.PM.changePage(\"\", tbData, function (data) {\r\n             //    $scope.TM.data = data.message;\r\n             //    history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n             //});\r\n             //$scope.changePage(1);\r\n\r\n             $scope.changePage = function (pageIndex, noHistory) {\r\n                 $(\"#tmBlock\").show();\r\n                 var pgData = $scope.PM.genPageData(pageIndex);\r\n                 var postData = {};\r\n                 postData.d = $scope.VM.title;\r\n                 postData.p = $scope.VM.publishState;\r\n                 postData = $scope.PM.filterPageData(pgData, postData);\r\n                 $scope.PM.changePage(\"/System/DocumentM/DocumentViewDownloadOP.aspx\", postData, function (data) {\r\n                     //console.log(data);\r\n                     //$scope.TM.tbHeadArray = [\"序號\", \"發佈日期\", \"上架狀態\", \"標題\"];\r\n                     //$scope.TM.tbFieldArray = [\"S\", \"P\", \"p\", \"D\"];\r\n                     //$scope.TM.isHide = false;\r\n                     $scope.TM.data = data.message;\r\n                     $scope.$apply(function () { });\r\n\r\n                     if (history.pushState && noHistory == undefined) {\r\n                         if (pageIndex > 1 || location.hash.length > 0) {\r\n                             history.pushState({ \"pageIndex\": pageIndex }, document.title, location.href.split(\"?\")[0] + \"?#h\");\r\n                         }\r\n                         else {\r\n                             history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n                         }\r\n                     }\r\n                 });\r\n             };\r\n\r\n             $scope.changePage(1);\r\n\r\n             hotkeys.add({\r\n                 combo: 'enter',\r\n                 description: 'Description goes here',\r\n                 allowIn: ['INPUT',\"BUTTON\", 'SELECT', 'TEXTAREA'],\r\n                 callback: function (event, hotkey) {\r\n                     var focusType = document.activeElement.type;\r\n                     if (focusType == \"text\" || focusType == \"select-one\" || (focusType == \"button\" && document.activeElement.name == \"searchBtn\"))\r\n                     {\r\n                         $scope.changePage(1);\r\n                         //event.preventDefault();\r\n                         //return false;\r\n                     }\r\n                 }\r\n             });\r\n\r\n             $scope.goDetail = function (record) {\r\n                 var obj = {};\r\n                 obj['i'] = record[\"I\"];\r\n                 TPM.doPOST(\"/System/DocumentM/DocumentViewDownload_Detail.aspx\", obj, document.querySelector(\"#MyForm\"));\r\n                \r\n             };\r\n\r\n}]);"]}