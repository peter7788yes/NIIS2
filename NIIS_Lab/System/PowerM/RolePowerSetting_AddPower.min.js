/*! NIIS 2016-05-09 */

$(function(){var a={};$.each(data,function(b,c){if(myTr="",0==c.PID){myTr='<tr id="x'+c.ID+'" haschildrens="0" class="pinkcolor" level="0" pid="'+c.PID+'"><td>'+c.ModuleName+"</td></tr>",$("#tableRoot tr:last").after(myTr);for(var d=$("#x"+c.ID),e=2;10>=e;e++)d.append('<td class="aCenter"><input type="checkbox" value="'+e+'"></td>');d.append('<td class="aCenter"><input type="button" style="margin-right:5px" value="全選" class="allBtn btn" /><input type="button" value="全不選" class="disAllBtn btn"/></td>')}else{var f=$("#x"+c.PID),g=parseInt(f.attr("haschildrens")),h={};if(g>0){h=f.next();for(var e=1;g-1>=e;e++)h=h.next()}else h=f;for(var i="",j=parseInt(f.attr("level"))+1,e=0;j>=e;e++)i+="&nbsp;&nbsp;&nbsp;";j>=2&&(i+="&nbsp;&nbsp;&nbsp;");var k="";1==j&&(k="yellowcolor"),h.after('<tr class="'+k+'" id="x'+c.ID+'" haschildrens="0" level="'+j+'" pid="'+c.PID+'"><td>'+i+c.ModuleName+"</td></tr>"),$("#x"+c.PID).attr("haschildrens",g+1);for(var d=$("#x"+c.ID),e=2;10>=e;e++)d.append('<td class="aCenter"><input type="checkbox" value="'+e+'"></td>');d.append('<td class="aCenter"><input type="button" value="全選" style="margin-right:5px" class="allBtn btn" /><input type="button" value="全不選"/ class="disAllBtn btn"></td>')}a=c});var b=[];$.each($("tr[level='0']"),function(a,c){b.push($(c).index())}),b.push($("#tableRoot>tbody>tr").length-1),$(document).on("change","tr[level='0']>td>input:checkbox",function(a){var c=$(this).prop("checked"),d=$(this).parent("td").parent("tr").index(),e=b.indexOf(d),f=d+1,g=b[e+1]-1;e+1==b.length-1&&(g=b[b.length-1]);for(var h=$(this).val(),i=$("#tableRoot>tbody>tr"),j=f;g>=j;j++){var k=i.get(j);$(k).find('input:checkbox[value="'+h+'"]').prop("checked",c)}return a.preventDefault(),!1});var c=[];$.each($("tr[level='0'],tr[level='1']"),function(a,b){c.push($(b).index())}),c.push($("#tableRoot>tbody>tr").length-1),$(document).on("change","tr[level='1']>td>input:checkbox",function(a){var d=$(this).prop("checked"),e=$(this).parent("td").parent("tr").index(),f=c.indexOf(e),g=e+1,h=c[f+1]-1;f+1==c.length-1&&(h=c[c.length-1]);for(var i=$(this).val(),j=$("#tableRoot>tbody>tr"),k=g;h>=k;k++){var l=j.get(k);$(l).find('input:checkbox[value="'+i+'"]').prop("checked",d)}var m=$(this).closest("tr"),n=m.attr("pid"),o=$("#x"+n),p=$(this).val(),q=o.index(),r=b.indexOf(q),s=q+1,t=b[r+1]-1;r+1==b.length-1&&(t=b[b.length-1]);for(var u=$("#tableRoot>tbody>tr"),v=0,k=s;t>=k;k++){var l=u.get(k);$.each($(l).find('input:checkbox[value="2"]'),function(a,b){1==$(b).prop("checked")&&v++})}return"2"==p?0==v?o.find("input:checkbox[value='"+p+"']").prop("checked",!1):o.find("input:checkbox[value='"+p+"']").prop("checked",!0):v-1!=t-s?o.find("input:checkbox[value='"+p+"']").prop("checked",!1):o.find("input:checkbox[value='"+p+"']").prop("checked",!0),a.preventDefault(),!1}),$(document).on("click",".allBtn",function(a){var d=$(this).closest("tr"),e=d.attr("level"),f=d.find("input:checkbox");switch(e){case"0":$.each(f,function(a,b){$(b).prop("checked",!1),$(b).trigger("click"),$(b).prop("checked",!0)});break;case"1":$.each(f,function(a,b){$(b).prop("checked",!1),$(b).trigger("click"),$(b).prop("checked",!0)});var g=d.attr("pid"),h=$("#x"+g),i=h.index(),j=b.indexOf(i),k=i+1,l=b[j+1]-1;j+1==b.length-1&&(l=b[b.length-1]);for(var m=$("#tableRoot>tbody>tr"),n=2;10>=n;n++){for(var o=0,p=k;l>=p;p++){var q=m.get(p);$.each($(q).find('input:checkbox[value="'+n+'"]'),function(a,b){1==$(b).prop("checked")&&o++})}"2"==n.toString()?0==o?h.find("input:checkbox[value='"+n+"']").prop("checked",!1):h.find("input:checkbox[value='"+n+"']").prop("checked",!0):o-1==l-k?h.find("input:checkbox[value='"+n+"']").prop("checked",!0):h.find("input:checkbox[value='"+n+"']").prop("checked",!1)}break;default:f.prop("checked",!1),f.trigger("click"),f.prop("checked",!0);var r=d.attr("pid"),h=$("#x"+r),s=h.index(),t=c.indexOf(s),u=s+1,v=c[t+1]-1;t+1==c.length-1&&(v=c[c.length-1]);for(var w=$("#tableRoot>tbody>tr"),n=2;10>=n;n++){for(var x=0,p=u;v>=p;p++){var q=w.get(p);$.each($(q).find('input:checkbox[value="'+n+'"]'),function(a,b){1==$(b).prop("checked")&&x++})}"2"==n.toString()?0==x?h.find("input:checkbox[value='"+n+"']").prop("checked",!1):h.find("input:checkbox[value='"+n+"']").prop("checked",!0):x-1==v-u?h.find("input:checkbox[value='"+n+"']").prop("checked",!0):h.find("input:checkbox[value='"+n+"']").prop("checked",!1)}var y=h.attr("pid"),z=$("#x"+y),i=z.index(),j=b.indexOf(i),k=i+1,l=b[j+1]-1;j+1==b.length-1&&(l=b[b.length-1]);for(var m=$("#tableRoot>tbody>tr"),n=2;10>=n;n++){for(var o=0,p=k;l>=p;p++){var q=m.get(p);$.each($(q).find('input:checkbox[value="'+n+'"]'),function(a,b){1==$(b).prop("checked")&&o++})}"2"==n.toString()?0==o?z.find("input:checkbox[value='"+n+"']").prop("checked",!1):z.find("input:checkbox[value='"+n+"']").prop("checked",!0):o-1==l-k?z.find("input:checkbox[value='"+n+"']").prop("checked",!0):z.find("input:checkbox[value='"+n+"']").prop("checked",!1)}}return a.preventDefault(),!1}),$(document).on("click",".disAllBtn",function(a){var d=$(this).closest("tr"),e=d.attr("level"),f=d.find("input:checkbox");switch(e){case"0":$.each(f,function(a,b){$(b).prop("checked",!0),$(b).trigger("click"),$(b).prop("checked",!1)});break;case"1":$.each(f,function(a,b){$(b).prop("checked",!0),$(b).trigger("click"),$(b).prop("checked",!1)});var g=d.attr("pid"),h=$("#x"+g),i=h.index(),j=b.indexOf(i),k=i+1,l=b[j+1]-1;j+1==b.length-1&&(l=b[b.length-1]);for(var m=$("#tableRoot>tbody>tr"),n=2;10>=n;n++){for(var o=0,p=k;l>=p;p++){var q=m.get(p);$.each($(q).find('input:checkbox[value="'+n+'"]'),function(a,b){1==$(b).prop("checked")&&o++})}"2"==n.toString()?0==o?h.find("input:checkbox[value='"+n+"']").prop("checked",!1):h.find("input:checkbox[value='"+n+"']").prop("checked",!0):o-1==l-k?h.find("input:checkbox[value='"+n+"']").prop("checked",!0):h.find("input:checkbox[value='"+n+"']").prop("checked",!1)}break;default:f.prop("checked",!0),f.trigger("click"),f.prop("checked",!1);var r=d.attr("pid"),h=$("#x"+r),s=h.index(),t=c.indexOf(s),u=s+1,v=c[t+1]-1;t+1==c.length-1&&(v=c[c.length-1]);for(var w=$("#tableRoot>tbody>tr"),n=2;10>=n;n++){for(var x=0,p=u;v>=p;p++){var q=w.get(p);$.each($(q).find('input:checkbox[value="'+n+'"]'),function(a,b){1==$(b).prop("checked")&&x++})}"2"==n.toString()?0==x?h.find("input:checkbox[value='"+n+"']").prop("checked",!1):h.find("input:checkbox[value='"+n+"']").prop("checked",!0):x-1==v-u?h.find("input:checkbox[value='"+n+"']").prop("checked",!0):h.find("input:checkbox[value='"+n+"']").prop("checked",!1)}var y=h.attr("pid"),z=$("#x"+y),i=z.index(),j=b.indexOf(i),k=i+1,l=b[j+1]-1;j+1==b.length-1&&(l=b[b.length-1]);for(var m=$("#tableRoot>tbody>tr"),n=2;10>=n;n++){for(var o=0,p=k;l>=p;p++){var q=m.get(p);$.each($(q).find('input:checkbox[value="'+n+'"]'),function(a,b){1==$(b).prop("checked")&&o++})}"2"==n.toString()?0==o?z.find("input:checkbox[value='"+n+"']").prop("checked",!1):z.find("input:checkbox[value='"+n+"']").prop("checked",!0):o-1==l-k?z.find("input:checkbox[value='"+n+"']").prop("checked",!0):z.find("input:checkbox[value='"+n+"']").prop("checked",!1)}}return a.preventDefault(),!1}),$(document).on("change","tr[level='2']>td>input:checkbox",function(a){var d=$(this).prop("checked"),e=$(this).closest("tr"),f=e.attr("pid"),g=$(this).val(),h=$("#x"+f),i=$("#x"+h.attr("pid")),j=$("tr[level='2'][pid='"+f+"']>td>input:checkbox[value='"+g+"']");if(1==d){var k=!0;$.each(j,function(a,b){0==$(b).prop("checked")&&(k=!1)}),1!=k&&"2"!=g||(h.find("input:checkbox[value='"+g+"']").prop("checked",!0),"2"==g&&i.find("input:checkbox[value='"+g+"']").prop("checked",!0))}else if("2"==g){var l=!0;$.each(h,function(a,b){1==$(b).prop("checked")&&(l=!1)}),1==l&&"2"!=g&&h.find("input:checkbox[value='"+g+"']").prop("checked",!1)}else h.find("input:checkbox[value='"+g+"']").prop("checked",!1);var m=h.index(),n=c.indexOf(m),o=m+1,p=c[n+1]-1;n+1==b.length-1&&(p=c[b.length-1]);for(var q=$("#tableRoot>tbody>tr"),r=0,s=o;p>=s;s++){var t=q.get(s);$.each($(t).find('input:checkbox[value="2"]'),function(a,b){1==$(b).prop("checked")&&r++})}"2"==g?0==r?h.find("input:checkbox[value='"+g+"']").prop("checked",!1):h.find("input:checkbox[value='"+g+"']").prop("checked",!0):r-1!=p-o?h.find("input:checkbox[value='"+g+"']").prop("checked",!1):h.find("input:checkbox[value='"+g+"']").prop("checked",!0);var u=i.index(),v=b.indexOf(u),w=u+1,x=b[v+1]-1;v+1==b.length-1&&(x=b[b.length-1]);for(var y=$("#tableRoot>tbody>tr"),z=0,s=w;x>=s;s++){var t=y.get(s);$.each($(t).find('input:checkbox[value="2"]'),function(a,b){1==$(b).prop("checked")&&z++})}"2"==g?0==z?i.find("input:checkbox[value='"+g+"']").prop("checked",!1):i.find("input:checkbox[value='"+g+"']").prop("checked",!0):z-1!=x-w?h.find("input:checkbox[value='"+g+"']").prop("checked",!1):h.find("input:checkbox[value='"+g+"']").prop("checked",!0)}),$(document).ajaxStart(function(){$("#loading").show()}).ajaxComplete(function(){$("#loading").hide()}),$(document).on("click","#btnSave",function(a){var b=$("#tableRoot>tbody>tr:not(:first)"),c=[];$.each(b,function(a,b){var d={};d.mId=parseInt($(b).attr("id").replace(/x/g,"")),d.ps="";for(var e=$(b).find("input:checkbox"),f=[],g=0;10>g;g++)f.push(0);f[0]=1,$.each(e,function(a,b){var c=parseInt($(b).val()),d=$(b).prop("checked");1==d&&(f[c-1]=1)}),d.ps=f.reverse().toString().replace(/,/g,""),c.push(d)}),document.querySelector("#hfV").value=JSON.stringify(c)}),$(document).on("click","#lastBtn",function(a){var b=[],c=[];return b[0]="sc",c[0]=CI,d("/System/PowerM/RolePowerSetting_Add.aspx",b,c),a.preventDefault(),!1});var d=function(a,b,c){b=b||[],c=c||[];var d="";if(d+="<html><head></head><body><form id='formid' method='post' action='"+a+"' autocomplete='off'>",b&&c&&b.length==c.length)for(var e=0;e<b.length;e++)d+="<input type='hidden' name='"+b[e]+"' value='"+c[e]+"'/>";d+="</form><script type='text/javascript'>document.getElementById(\"formid\").submit()</script></body></html>",document.write(d)}});
//# sourceMappingURL=RolePowerSetting_AddPower.min.js.map