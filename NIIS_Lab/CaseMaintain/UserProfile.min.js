/*! NIIS 2016-03-07 */

function GetMainContactInfo(){var iCaseID=CaseID,iContactCaseID=$("#MainContact").val();if("0"!=iContactCaseID){var postData={};postData.CaseID=iCaseID,postData.ContactCaseID=iContactCaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/CaseUserGetContactInfoOP.aspx",data:postData,async:!1}).done(function(response){var reply=eval(response);"1"==reply.RetCode&&$("#MainContactInfo").html(reply.Content)}).fail(function(a,b){})}else{var sb="";sb+="<table>",sb+="<tr><td style='width:90px'>電話(日)：</td><td>"+$(".tbTelDayArea").val()+" "+$(".tbTelDayNo").val()+"分機"+$(".tbTelDayExt").val()+"</td></tr>",sb+="<tr><td>電話(夜)：</td><td>"+$(".tbTelNightArea").val()+" "+$(".tbTelNightNo").val()+"分機"+$(".tbTelNightExt").val()+"</td></tr>",sb+="<tr><td>行動電話：</td><td>"+$(".tbMobile").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="<tr><td>電子郵件：</td><td>"+$(".tbEmail").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="</table>",$("#MainContactInfo").html(sb)}}function LoadContactList(){var ContactData={};ContactData.action="LoadContactList",ContactData.CaseID=CaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#CaseContactList").html(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function AddContactTr(iContactID){$("#NewCaseUserContactIDs").val($("#NewCaseUserContactIDs").val()+","+iContactID);var ContactData={};ContactData.action="GetContactTr",ContactData.ContactID=iContactID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#Contact_TB").append(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function deleteContact(obj){var iContactID=$(obj).attr("id").replace("DeleteContact_","");$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:{action:"Delete",ContactID:iContactID}}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&$(obj).parent().parent().html("")})}function checkID(a,b){var c=b.Value;if(0==c.search(/^(9)(9)\d{8}$/i))b.IsValid=!0;else{var d,e,f,g=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),h=new Array(1,9,8,7,6,5,4,3,2,1),i=new Array(2),j=0,k=/^[a-z](1|2)\d{8}$/i;if(-1==c.search(k))b.IsValid=!1;else{d=c.charAt(0).toUpperCase(),f=c.charAt(9);for(var l=0;26>l;l++)if(d==g[l]){e=l+10,i[0]=Math.floor(e/10),i[1]=e-10*i[0];break}for(var l=0;l<h.length;l++)j+=2>l?i[l]*h[l]:parseInt(c.charAt(l-1))*h[l];(parseInt(j)+parseInt(f))%10==0?b.IsValid=!0:b.IsValid=!1}}}function checkRes(a,b){var c,d,e,f,g,h=b.Value,i=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),j=new Array(1,9,8,7,6,5,4,3,2,1),k=new Array(3),l=0,m=/^[a-z][a-d](1|2)\d{7}$/i;if(-1==h.search(m))b.IsValid=!1;else{c=h.charAt(0).toUpperCase(),d=h.charAt(1).toUpperCase(),g=h.charAt(9);for(var n=0;26>n;n++)if(c==i[n]){e=n+10,k[0]=Math.floor(e/10),k[1]=e-10*k[0];break}for(var n=0;26>n;n++)if(d==i[n]){f=n+10,k[2]=f-10*Math.floor(f/10);break}for(var n=0;n<j.length;n++)l+=3>n?k[n]*j[n]:parseInt(h.charAt(n-1))*j[n];(parseInt(l)+parseInt(g))%10==0?b.IsValid=!0:b.IsValid=!1}}function GetMainContactInfo(){var iCaseID=CaseID,iContactCaseID=$("#MainContact").val();if("0"!=iContactCaseID){var postData={};postData.CaseID=iCaseID,postData.ContactCaseID=iContactCaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/CaseUserGetContactInfoOP.aspx",data:postData,async:!1}).done(function(response){var reply=eval(response);"1"==reply.RetCode&&$("#MainContactInfo").html(reply.Content)}).fail(function(a,b){})}else{var sb="";sb+="<table>",sb+="<tr><td style='width:90px'>電話(日)：</td><td>"+$(".tbTelDayArea").val()+" "+$(".tbTelDayNo").val()+"分機"+$(".tbTelDayExt").val()+"</td></tr>",sb+="<tr><td>電話(夜)：</td><td>"+$(".tbTelNightArea").val()+" "+$(".tbTelNightNo").val()+"分機"+$(".tbTelNightExt").val()+"</td></tr>",sb+="<tr><td>行動電話：</td><td>"+$(".tbMobile").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="<tr><td>電子郵件：</td><td>"+$(".tbEmail").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="</table>",$("#MainContactInfo").html(sb)}}function LoadContactList(){var ContactData={};ContactData.action="LoadContactList",ContactData.CaseID=CaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#CaseContactList").html(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function AddContactTr(iContactID){$("#NewCaseUserContactIDs").val($("#NewCaseUserContactIDs").val()+","+iContactID);var ContactData={};ContactData.action="GetContactTr",ContactData.ContactID=iContactID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#Contact_TB").append(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function deleteContact(obj){var iContactID=$(obj).attr("id").replace("DeleteContact_","");$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:{action:"Delete",ContactID:iContactID}}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&$(obj).parent().parent().html("")})}function checkID(a,b){var c=b.Value;if(0==c.search(/^(9)(9)\d{8}$/i))b.IsValid=!0;else{var d,e,f,g=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),h=new Array(1,9,8,7,6,5,4,3,2,1),i=new Array(2),j=0,k=/^[a-z](1|2)\d{8}$/i;if(-1==c.search(k))b.IsValid=!1;else{d=c.charAt(0).toUpperCase(),f=c.charAt(9);for(var l=0;26>l;l++)if(d==g[l]){e=l+10,i[0]=Math.floor(e/10),i[1]=e-10*i[0];break}for(var l=0;l<h.length;l++)j+=2>l?i[l]*h[l]:parseInt(c.charAt(l-1))*h[l];(parseInt(j)+parseInt(f))%10==0?b.IsValid=!0:b.IsValid=!1}}}function checkRes(a,b){var c,d,e,f,g,h=b.Value,i=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),j=new Array(1,9,8,7,6,5,4,3,2,1),k=new Array(3),l=0,m=/^[a-z][a-d](1|2)\d{7}$/i;if(-1==h.search(m))b.IsValid=!1;else{c=h.charAt(0).toUpperCase(),d=h.charAt(1).toUpperCase(),g=h.charAt(9);for(var n=0;26>n;n++)if(c==i[n]){e=n+10,k[0]=Math.floor(e/10),k[1]=e-10*k[0];break}for(var n=0;26>n;n++)if(d==i[n]){f=n+10,k[2]=f-10*Math.floor(f/10);break}for(var n=0;n<j.length;n++)l+=3>n?k[n]*j[n]:parseInt(h.charAt(n-1))*j[n];(parseInt(l)+parseInt(g))%10==0?b.IsValid=!0:b.IsValid=!1}}function GetMainContactInfo(){var iCaseID=CaseID,iContactCaseID=$("#MainContact").val();if("0"!=iContactCaseID){var postData={};postData.CaseID=iCaseID,postData.ContactCaseID=iContactCaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/CaseUserGetContactInfoOP.aspx",data:postData,async:!1}).done(function(response){var reply=eval(response);"1"==reply.RetCode&&$("#MainContactInfo").html(reply.Content)}).fail(function(a,b){})}else{var sb="";sb+="<table>",sb+="<tr><td style='width:90px'>電話(日)：</td><td>"+$(".tbTelDayArea").val()+" "+$(".tbTelDayNo").val()+"分機"+$(".tbTelDayExt").val()+"</td></tr>",sb+="<tr><td>電話(夜)：</td><td>"+$(".tbTelNightArea").val()+" "+$(".tbTelNightNo").val()+"分機"+$(".tbTelNightExt").val()+"</td></tr>",sb+="<tr><td>行動電話：</td><td>"+$(".tbMobile").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="<tr><td>電子郵件：</td><td>"+$(".tbEmail").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="</table>",$("#MainContactInfo").html(sb)}}function LoadContactList(){var ContactData={};ContactData.action="LoadContactList",ContactData.CaseID=CaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#CaseContactList").html(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function AddContactTr(iContactID){$("#NewCaseUserContactIDs").val($("#NewCaseUserContactIDs").val()+","+iContactID);var ContactData={};ContactData.action="GetContactTr",ContactData.ContactID=iContactID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#Contact_TB").append(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function deleteContact(obj){var iContactID=$(obj).attr("id").replace("DeleteContact_","");$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:{action:"Delete",ContactID:iContactID}}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&$(obj).parent().parent().html("")})}function checkID(a,b){var c=b.Value;if(0==c.search(/^(9)(9)\d{8}$/i))b.IsValid=!0;else{var d,e,f,g=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),h=new Array(1,9,8,7,6,5,4,3,2,1),i=new Array(2),j=0,k=/^[a-z](1|2)\d{8}$/i;if(-1==c.search(k))b.IsValid=!1;else{d=c.charAt(0).toUpperCase(),f=c.charAt(9);for(var l=0;26>l;l++)if(d==g[l]){e=l+10,i[0]=Math.floor(e/10),i[1]=e-10*i[0];break}for(var l=0;l<h.length;l++)j+=2>l?i[l]*h[l]:parseInt(c.charAt(l-1))*h[l];(parseInt(j)+parseInt(f))%10==0?b.IsValid=!0:b.IsValid=!1}}}function checkRes(a,b){var c,d,e,f,g,h=b.Value,i=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),j=new Array(1,9,8,7,6,5,4,3,2,1),k=new Array(3),l=0,m=/^[a-z][a-d](1|2)\d{7}$/i;if(-1==h.search(m))b.IsValid=!1;else{c=h.charAt(0).toUpperCase(),d=h.charAt(1).toUpperCase(),g=h.charAt(9);for(var n=0;26>n;n++)if(c==i[n]){e=n+10,k[0]=Math.floor(e/10),k[1]=e-10*k[0];break}for(var n=0;26>n;n++)if(d==i[n]){f=n+10,k[2]=f-10*Math.floor(f/10);break}for(var n=0;n<j.length;n++)l+=3>n?k[n]*j[n]:parseInt(h.charAt(n-1))*j[n];(parseInt(l)+parseInt(g))%10==0?b.IsValid=!0:b.IsValid=!1}}function GetMainContactInfo(){var iCaseID=CaseID,iContactCaseID=$("#MainContact").val();if("0"!=iContactCaseID){var postData={};postData.CaseID=iCaseID,postData.ContactCaseID=iContactCaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/CaseUserGetContactInfoOP.aspx",data:postData,async:!1}).done(function(response){var reply=eval(response);"1"==reply.RetCode&&$("#MainContactInfo").html(reply.Content)}).fail(function(a,b){})}else{var sb="";sb+="<table>",sb+="<tr><td style='width:90px'>電話(日)：</td><td>"+$(".tbTelDayArea").val()+" "+$(".tbTelDayNo").val()+"分機"+$(".tbTelDayExt").val()+"</td></tr>",sb+="<tr><td>電話(夜)：</td><td>"+$(".tbTelNightArea").val()+" "+$(".tbTelNightNo").val()+"分機"+$(".tbTelNightExt").val()+"</td></tr>",sb+="<tr><td>行動電話：</td><td>"+$(".tbMobile").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="<tr><td>電子郵件：</td><td>"+$(".tbEmail").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="</table>",$("#MainContactInfo").html(sb)}}function LoadContactList(){var ContactData={};ContactData.action="LoadContactList",ContactData.CaseID=CaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#CaseContactList").html(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function AddContactTr(iContactID){$("#NewCaseUserContactIDs").val($("#NewCaseUserContactIDs").val()+","+iContactID);var ContactData={};ContactData.action="GetContactTr",ContactData.ContactID=iContactID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#Contact_TB").append(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function deleteContact(obj){var iContactID=$(obj).attr("id").replace("DeleteContact_","");$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:{action:"Delete",ContactID:iContactID}}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&$(obj).parent().parent().html("")})}function checkID(a,b){var c=b.Value;if(0==c.search(/^(9)(9)\d{8}$/i))b.IsValid=!0;else{var d,e,f,g=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),h=new Array(1,9,8,7,6,5,4,3,2,1),i=new Array(2),j=0,k=/^[a-z](1|2)\d{8}$/i;if(-1==c.search(k))b.IsValid=!1;else{d=c.charAt(0).toUpperCase(),f=c.charAt(9);for(var l=0;26>l;l++)if(d==g[l]){e=l+10,i[0]=Math.floor(e/10),i[1]=e-10*i[0];break}for(var l=0;l<h.length;l++)j+=2>l?i[l]*h[l]:parseInt(c.charAt(l-1))*h[l];(parseInt(j)+parseInt(f))%10==0?b.IsValid=!0:b.IsValid=!1}}}function checkRes(a,b){var c,d,e,f,g,h=b.Value,i=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),j=new Array(1,9,8,7,6,5,4,3,2,1),k=new Array(3),l=0,m=/^[a-z][a-d](1|2)\d{7}$/i;if(-1==h.search(m))b.IsValid=!1;else{c=h.charAt(0).toUpperCase(),d=h.charAt(1).toUpperCase(),g=h.charAt(9);for(var n=0;26>n;n++)if(c==i[n]){e=n+10,k[0]=Math.floor(e/10),k[1]=e-10*k[0];break}for(var n=0;26>n;n++)if(d==i[n]){f=n+10,k[2]=f-10*Math.floor(f/10);break}for(var n=0;n<j.length;n++)l+=3>n?k[n]*j[n]:parseInt(h.charAt(n-1))*j[n];(parseInt(l)+parseInt(g))%10==0?b.IsValid=!0:b.IsValid=!1}}function GetMainContactInfo(){var iCaseID=CaseID,iContactCaseID=$("#MainContact").val();if("0"!=iContactCaseID){var postData={};postData.CaseID=iCaseID,postData.ContactCaseID=iContactCaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/CaseUserGetContactInfoOP.aspx",data:postData,async:!1}).done(function(response){var reply=eval(response);"1"==reply.RetCode&&$("#MainContactInfo").html(reply.Content)}).fail(function(a,b){})}else{var sb="";sb+="<table>",sb+="<tr><td style='width:90px'>電話(日)：</td><td>"+$(".tbTelDayArea").val()+" "+$(".tbTelDayNo").val()+"分機"+$(".tbTelDayExt").val()+"</td></tr>",sb+="<tr><td>電話(夜)：</td><td>"+$(".tbTelNightArea").val()+" "+$(".tbTelNightNo").val()+"分機"+$(".tbTelNightExt").val()+"</td></tr>",sb+="<tr><td>行動電話：</td><td>"+$(".tbMobile").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="<tr><td>電子郵件：</td><td>"+$(".tbEmail").map(function(){return"<div>"+$(this).val()+"</div>"}).get().join(" ")+"</td></tr>",sb+="</table>",$("#MainContactInfo").html(sb)}}function LoadContactList(){var ContactData={};ContactData.action="LoadContactList",ContactData.CaseID=CaseID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#CaseContactList").html(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function AddContactTr(iContactID){$("#NewCaseUserContactIDs").val($("#NewCaseUserContactIDs").val()+","+iContactID);var ContactData={};ContactData.action="GetContactTr",ContactData.ContactID=iContactID,$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:ContactData}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&($("#Contact_TB").append(reply.Content),$(".ModifyContact").click(function(){var a=$(this).attr("id").replace("ModifyContact_","");OpenWindowWithPostOptions("/CaseMaintain/UserContact.aspx",600,508,"UserContact",{ContactID:a})}),$(".DeleteContact").click(function(){confirm("確定刪除?")&&deleteContact($(this))}))}).fail(function(a,b){})}function deleteContact(obj){var iContactID=$(obj).attr("id").replace("DeleteContact_","");$.ajax({cache:!1,type:"POST",url:"/CaseMaintain/UserProfileContactListOP.aspx",data:{action:"Delete",ContactID:iContactID}}).done(function(data){var reply=eval(data);"1"==reply.RetCode&&$(obj).parent().parent().html("")})}function checkID(a,b){var c=b.Value;if(0==c.search(/^(9)(9)\d{8}$/i))b.IsValid=!0;else{var d,e,f,g=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),h=new Array(1,9,8,7,6,5,4,3,2,1),i=new Array(2),j=0,k=/^[a-z](1|2)\d{8}$/i;if(-1==c.search(k))b.IsValid=!1;else{d=c.charAt(0).toUpperCase(),f=c.charAt(9);for(var l=0;26>l;l++)if(d==g[l]){e=l+10,i[0]=Math.floor(e/10),i[1]=e-10*i[0];break}for(var l=0;l<h.length;l++)j+=2>l?i[l]*h[l]:parseInt(c.charAt(l-1))*h[l];(parseInt(j)+parseInt(f))%10==0?b.IsValid=!0:b.IsValid=!1}}}function checkRes(a,b){var c,d,e,f,g,h=b.Value,i=new Array("A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","X","Y","W","Z","I","O"),j=new Array(1,9,8,7,6,5,4,3,2,1),k=new Array(3),l=0,m=/^[a-z][a-d](1|2)\d{7}$/i;if(-1==h.search(m))b.IsValid=!1;else{c=h.charAt(0).toUpperCase(),d=h.charAt(1).toUpperCase(),g=h.charAt(9);for(var n=0;26>n;n++)if(c==i[n]){e=n+10,k[0]=Math.floor(e/10),k[1]=e-10*k[0];break}for(var n=0;26>n;n++)if(d==i[n]){f=n+10,k[2]=f-10*Math.floor(f/10);break}for(var n=0;n<j.length;n++)l+=3>n?k[n]*j[n]:parseInt(h.charAt(n-1))*j[n];(parseInt(l)+parseInt(g))%10==0?b.IsValid=!0:b.IsValid=!1}}$(function(){$(document).on("click","#imgCapacity",function(a){return OpenWindowWithPostOptions("/CaseMaintain/CapacityHistory.aspx",600,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#btnSameRes",function(a){return $(".ConCounty").html($(".ResCounty").html()).val($(".ResCounty").val()),$(".ConTown").html($(".ResTown").html()).val($(".ResTown").val()),$(".ConVillage").html($(".ResVillage").html()).val($(".ResVillage").val()),$(".ConNei").val($(".ResNei").val()),$(".ConAddr").val($(".ResAddr").val()),a.preventDefault(),!1}),$(document).on("click","#ModifyLogTab",function(a){return $scope.changePage(),a.preventDefault(),!1}),$(document).on("click",".DelPS",function(a){$(this).parent().html("")}),$(document).on("click",".AddPS",function(a){$(".CommentAreaDIV").append("<div>"+$("#CommentSample").html()+"</div>")}),$(document).on("click",".AddContract",function(a){return OpenWindowWithPostOptions("/CaseMaintain/ChooseUserContactList.aspx",608,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#BackToList",function(a){location.href="UserProfileList.aspx"}),$(".ConCounty").val(CountyInival),$(".ConTown").val(TownInival),$(".ConVillage").val(VillageInival),$(".ResCounty").val(ResCountyInival),$(".ResTown").val(ResTownInival),$(".ResVillage").val(ResVillageInival),$(document).on("click",".DelMobile,.DelEmail",function(a){$(this).parent().html(""),GetMainContactInfo()}),$(document).on("click",".AddMobile",function(a){$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>")}),$(document).on("click",".AddEmail",function(a){$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>")}),$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>"),$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>"),$(document).on("change","#MainContact",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$(document).on("change",".tbTelDayArea,.tbTelDayNo,.tbTelNightExt,.tbTelNightArea,.tbTelNightNo,.tbTelNightExt,.tbMobile,.tbEmail",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$("#MainContact").val(MainContactInival),LoadContactList()}),angular.module("MyApp",["PageM","TableM","FilterM"]).controller("MyController",["$scope","PageProvider","TableProvider",function(a,b,c,d){a.PM=b,a.TM={},a.VM={},a.VM.CountyAry=[{I:"0",N:"縣市"}].concat(Countydata),a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(Towndata),a.VM.VillageAry=[{I:"0",N:"村里"}].concat(Villagedata),a.VM.SelectCounty="0",a.VM.SelectTown="0",a.VM.SelectVillage="0",a.VM.ResCountyAry=[{I:"0",N:"縣市"}].concat(ResCountydata),a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(ResTowndata),a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(ResVillagedata),a.VM.SelectResCounty="0",a.VM.SelectResTown="0",a.VM.SelectResVillage="0",a.changePage=function(b){$("#tmBlock").show();var c=a.PM.genPageData(b),d={};d.CaseID=$(".CaseID").html(),d=a.PM.filterPageData(c,d),a.PM.changePage("/CaseMaintain/UserProfileModifyListOP.aspx",d,function(b){a.TM.data=b.message,a.$apply(function(){})})},a.changePage(1),a.SelectResTownChange=function(){var b={};b.a="Village",b.p=$(".ResTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.ResVillageAry=[{I:"0",N:"村里"}],a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectResCountyChange=function(){var b={};b.a="Town",b.p=$(".ResCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.ResVillageAry=[{I:"0",N:"村里"}]):(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.ResVillageAry=[{I:"0",N:"村里"}]),a.VM.SelectResTown="0",a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectConTownChange=function(){var b={};b.a="Village",b.p=$(".ConTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.VillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.VillageAry=[{I:"0",N:"村里"}],a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})},a.SelectConCountyChange=function(){var b={};b.a="Town",b.p=$(".ConCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.VillageAry=[{I:"0",N:"村里"}]):(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.VillageAry=[{I:"0",N:"村里"}]),a.VM.SelectTown="0",a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})}}]),$(function(){$(document).on("click","#imgCapacity",function(a){return OpenWindowWithPostOptions("/CaseMaintain/CapacityHistory.aspx",600,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#btnSameRes",function(a){return $(".ConCounty").html($(".ResCounty").html()).val($(".ResCounty").val()),$(".ConTown").html($(".ResTown").html()).val($(".ResTown").val()),$(".ConVillage").html($(".ResVillage").html()).val($(".ResVillage").val()),$(".ConNei").val($(".ResNei").val()),$(".ConAddr").val($(".ResAddr").val()),a.preventDefault(),!1}),$(document).on("click","#ModifyLogTab",function(a){return $scope.changePage(),a.preventDefault(),!1}),$(document).on("click",".DelPS",function(a){$(this).parent().html("")}),$(document).on("click",".AddPS",function(a){$(".CommentAreaDIV").append("<div>"+$("#CommentSample").html()+"</div>")}),$(document).on("click",".AddContract",function(a){return OpenWindowWithPostOptions("/CaseMaintain/ChooseUserContactList.aspx",608,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#BackToList",function(a){location.href="UserProfileList.aspx"}),$(".ConCounty").val(CountyInival),$(".ConTown").val(TownInival),$(".ConVillage").val(VillageInival),$(".ResCounty").val(ResCountyInival),$(".ResTown").val(ResTownInival),$(".ResVillage").val(ResVillageInival),$(document).on("click",".DelMobile,.DelEmail",function(a){$(this).parent().html(""),GetMainContactInfo()}),$(document).on("click",".AddMobile",function(a){$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>")}),$(document).on("click",".AddEmail",function(a){$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>")}),$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>"),$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>"),$(document).on("change","#MainContact",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$(document).on("change",".tbTelDayArea,.tbTelDayNo,.tbTelNightExt,.tbTelNightArea,.tbTelNightNo,.tbTelNightExt,.tbMobile,.tbEmail",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$("#MainContact").val(MainContactInival),LoadContactList()}),angular.module("MyApp",["PageM","TableM","FilterM"]).controller("MyController",["$scope","PageProvider","TableProvider",function(a,b,c,d){a.PM=b,a.TM={},a.VM={},a.VM.CountyAry=[{I:"0",N:"縣市"}].concat(Countydata),a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(Towndata),a.VM.VillageAry=[{I:"0",N:"村里"}].concat(Villagedata),a.VM.SelectCounty="0",a.VM.SelectTown="0",a.VM.SelectVillage="0",a.VM.ResCountyAry=[{I:"0",N:"縣市"}].concat(ResCountydata),a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(ResTowndata),a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(ResVillagedata),a.VM.SelectResCounty="0",a.VM.SelectResTown="0",a.VM.SelectResVillage="0",a.changePage=function(b){$("#tmBlock").show();var c=a.PM.genPageData(b),d={};d.CaseID=$(".CaseID").html(),d=a.PM.filterPageData(c,d),a.PM.changePage("/CaseMaintain/UserProfileModifyListOP.aspx",d,function(b){a.TM.data=b.message,a.$apply(function(){})})},a.changePage(1),a.SelectResTownChange=function(){var b={};b.a="Village",b.p=$(".ResTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.ResVillageAry=[{I:"0",N:"村里"}],a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectResCountyChange=function(){var b={};b.a="Town",b.p=$(".ResCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.ResVillageAry=[{I:"0",N:"村里"}]):(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.ResVillageAry=[{I:"0",N:"村里"}]),a.VM.SelectResTown="0",a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectConTownChange=function(){var b={};b.a="Village",b.p=$(".ConTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.VillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.VillageAry=[{I:"0",N:"村里"}],a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})},a.SelectConCountyChange=function(){var b={};b.a="Town",b.p=$(".ConCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.VillageAry=[{I:"0",N:"村里"}]):(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.VillageAry=[{I:"0",N:"村里"}]),a.VM.SelectTown="0",a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})}}]),$(function(){$(document).on("click","#imgCapacity",function(a){return OpenWindowWithPostOptions("/CaseMaintain/CapacityHistory.aspx",600,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#btnSameRes",function(a){return $(".ConCounty").html($(".ResCounty").html()).val($(".ResCounty").val()),$(".ConTown").html($(".ResTown").html()).val($(".ResTown").val()),$(".ConVillage").html($(".ResVillage").html()).val($(".ResVillage").val()),$(".ConNei").val($(".ResNei").val()),$(".ConAddr").val($(".ResAddr").val()),a.preventDefault(),!1}),$(document).on("click","#ModifyLogTab",function(a){return $scope.changePage(),a.preventDefault(),!1}),$(document).on("click",".DelPS",function(a){$(this).parent().html("")}),$(document).on("click",".AddPS",function(a){$(".CommentAreaDIV").append("<div>"+$("#CommentSample").html()+"</div>")}),$(document).on("click",".AddContract",function(a){return OpenWindowWithPostOptions("/CaseMaintain/ChooseUserContactList.aspx",608,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#BackToList",function(a){location.href="UserProfileList.aspx"}),$(".ConCounty").val(CountyInival),$(".ConTown").val(TownInival),$(".ConVillage").val(VillageInival),$(".ResCounty").val(ResCountyInival),$(".ResTown").val(ResTownInival),$(".ResVillage").val(ResVillageInival),$(document).on("click",".DelMobile,.DelEmail",function(a){$(this).parent().html(""),GetMainContactInfo()}),$(document).on("click",".AddMobile",function(a){$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>")}),$(document).on("click",".AddEmail",function(a){$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>")}),$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>"),$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>"),$(document).on("change","#MainContact",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$(document).on("change",".tbTelDayArea,.tbTelDayNo,.tbTelNightExt,.tbTelNightArea,.tbTelNightNo,.tbTelNightExt,.tbMobile,.tbEmail",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$("#MainContact").val(MainContactInival),LoadContactList()}),angular.module("MyApp",["PageM","TableM","FilterM"]).controller("MyController",["$scope","PageProvider","TableProvider",function(a,b,c,d){a.PM=b,a.TM={},a.VM={},a.VM.CountyAry=[{I:"0",N:"縣市"}].concat(Countydata),a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(Towndata),a.VM.VillageAry=[{I:"0",N:"村里"}].concat(Villagedata),a.VM.SelectCounty="0",a.VM.SelectTown="0",a.VM.SelectVillage="0",a.VM.ResCountyAry=[{I:"0",N:"縣市"}].concat(ResCountydata),a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(ResTowndata),a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(ResVillagedata),a.VM.SelectResCounty="0",a.VM.SelectResTown="0",a.VM.SelectResVillage="0",a.changePage=function(b){$("#tmBlock").show();var c=a.PM.genPageData(b),d={};d.CaseID=$(".CaseID").html(),d=a.PM.filterPageData(c,d),a.PM.changePage("/CaseMaintain/UserProfileModifyListOP.aspx",d,function(b){a.TM.data=b.message,a.$apply(function(){})})},a.changePage(1),a.SelectResTownChange=function(){var b={};b.a="Village",b.p=$(".ResTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){
a.$apply(function(){b.length>0?a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.ResVillageAry=[{I:"0",N:"村里"}],a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectResCountyChange=function(){var b={};b.a="Town",b.p=$(".ResCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.ResVillageAry=[{I:"0",N:"村里"}]):(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.ResVillageAry=[{I:"0",N:"村里"}]),a.VM.SelectResTown="0",a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectConTownChange=function(){var b={};b.a="Village",b.p=$(".ConTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.VillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.VillageAry=[{I:"0",N:"村里"}],a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})},a.SelectConCountyChange=function(){var b={};b.a="Town",b.p=$(".ConCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.VillageAry=[{I:"0",N:"村里"}]):(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.VillageAry=[{I:"0",N:"村里"}]),a.VM.SelectTown="0",a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})}}]),$(function(){$(document).on("click","#imgCapacity",function(a){return OpenWindowWithPostOptions("/CaseMaintain/CapacityHistory.aspx",600,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#btnSameRes",function(a){return $(".ConCounty").html($(".ResCounty").html()).val($(".ResCounty").val()),$(".ConTown").html($(".ResTown").html()).val($(".ResTown").val()),$(".ConVillage").html($(".ResVillage").html()).val($(".ResVillage").val()),$(".ConNei").val($(".ResNei").val()),$(".ConAddr").val($(".ResAddr").val()),a.preventDefault(),!1}),$(document).on("click","#ModifyLogTab",function(a){return $scope.changePage(),a.preventDefault(),!1}),$(document).on("click",".DelPS",function(a){$(this).parent().html("")}),$(document).on("click",".AddPS",function(a){$(".CommentAreaDIV").append("<div>"+$("#CommentSample").html()+"</div>")}),$(document).on("click",".AddContract",function(a){return OpenWindowWithPostOptions("/CaseMaintain/ChooseUserContactList.aspx",608,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#BackToList",function(a){location.href="UserProfileList.aspx"}),$(".ConCounty").val(CountyInival),$(".ConTown").val(TownInival),$(".ConVillage").val(VillageInival),$(".ResCounty").val(ResCountyInival),$(".ResTown").val(ResTownInival),$(".ResVillage").val(ResVillageInival),$(document).on("click",".DelMobile,.DelEmail",function(a){$(this).parent().html(""),GetMainContactInfo()}),$(document).on("click",".AddMobile",function(a){$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>")}),$(document).on("click",".AddEmail",function(a){$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>")}),$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>"),$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>"),$(document).on("change","#MainContact",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$(document).on("change",".tbTelDayArea,.tbTelDayNo,.tbTelNightExt,.tbTelNightArea,.tbTelNightNo,.tbTelNightExt,.tbMobile,.tbEmail",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$("#MainContact").val(MainContactInival),LoadContactList()}),angular.module("MyApp",["PageM","TableM","FilterM"]).controller("MyController",["$scope","PageProvider","TableProvider",function(a,b,c,d){a.PM=b,a.TM={},a.VM={},a.VM.CountyAry=[{I:"0",N:"縣市"}].concat(Countydata),a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(Towndata),a.VM.VillageAry=[{I:"0",N:"村里"}].concat(Villagedata),a.VM.SelectCounty="0",a.VM.SelectTown="0",a.VM.SelectVillage="0",a.VM.ResCountyAry=[{I:"0",N:"縣市"}].concat(ResCountydata),a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(ResTowndata),a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(ResVillagedata),a.VM.SelectResCounty="0",a.VM.SelectResTown="0",a.VM.SelectResVillage="0",a.changePage=function(b){$("#tmBlock").show();var c=a.PM.genPageData(b),d={};d.CaseID=$(".CaseID").html(),d=a.PM.filterPageData(c,d),a.PM.changePage("/CaseMaintain/UserProfileModifyListOP.aspx",d,function(b){a.TM.data=b.message,a.$apply(function(){})})},a.changePage(1),a.SelectResTownChange=function(){var b={};b.a="Village",b.p=$(".ResTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.ResVillageAry=[{I:"0",N:"村里"}],a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectResCountyChange=function(){var b={};b.a="Town",b.p=$(".ResCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.ResVillageAry=[{I:"0",N:"村里"}]):(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.ResVillageAry=[{I:"0",N:"村里"}]),a.VM.SelectResTown="0",a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectConTownChange=function(){var b={};b.a="Village",b.p=$(".ConTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.VillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.VillageAry=[{I:"0",N:"村里"}],a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})},a.SelectConCountyChange=function(){var b={};b.a="Town",b.p=$(".ConCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.VillageAry=[{I:"0",N:"村里"}]):(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.VillageAry=[{I:"0",N:"村里"}]),a.VM.SelectTown="0",a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})}}]),$(function(){$(document).on("click","#imgCapacity",function(a){return OpenWindowWithPostOptions("/CaseMaintain/CapacityHistory.aspx",600,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#btnSameRes",function(a){return $(".ConCounty").html($(".ResCounty").html()).val($(".ResCounty").val()),$(".ConTown").html($(".ResTown").html()).val($(".ResTown").val()),$(".ConVillage").html($(".ResVillage").html()).val($(".ResVillage").val()),$(".ConNei").val($(".ResNei").val()),$(".ConAddr").val($(".ResAddr").val()),a.preventDefault(),!1}),$(document).on("click","#ModifyLogTab",function(a){return $scope.changePage(),a.preventDefault(),!1}),$(document).on("click",".DelPS",function(a){$(this).parent().html("")}),$(document).on("click",".AddPS",function(a){$(".CommentAreaDIV").append("<div>"+$("#CommentSample").html()+"</div>")}),$(document).on("click",".AddContract",function(a){return OpenWindowWithPostOptions("/CaseMaintain/ChooseUserContactList.aspx",608,508,"CapacityHistory",{i:CaseID}),a.preventDefault(),!1}),$(document).on("click","#BackToList",function(a){location.href="UserProfileList.aspx"}),$(".ConCounty").val(CountyInival),$(".ConTown").val(TownInival),$(".ConVillage").val(VillageInival),$(".ResCounty").val(ResCountyInival),$(".ResTown").val(ResTownInival),$(".ResVillage").val(ResVillageInival),$(document).on("click",".DelMobile,.DelEmail",function(a){$(this).parent().html(""),GetMainContactInfo()}),$(document).on("click",".AddMobile",function(a){$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>")}),$(document).on("click",".AddEmail",function(a){$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>")}),$(".MobileDIV").append("<div>"+$("#MobileSample").html()+"</div>"),$(".EmailDIV").append("<div>"+$("#EmailSample").html()+"</div>"),$(document).on("change","#MainContact",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$(document).on("change",".tbTelDayArea,.tbTelDayNo,.tbTelNightExt,.tbTelNightArea,.tbTelNightNo,.tbTelNightExt,.tbMobile,.tbEmail",function(a){return GetMainContactInfo(),a.preventDefault(),!1}),$("#MainContact").val(MainContactInival),LoadContactList()}),angular.module("MyApp",["PageM","TableM","FilterM"]).controller("MyController",["$scope","PageProvider","TableProvider",function(a,b,c,d){a.PM=b,a.TM={},a.VM={},a.VM.CountyAry=[{I:"0",N:"縣市"}].concat(Countydata),a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(Towndata),a.VM.VillageAry=[{I:"0",N:"村里"}].concat(Villagedata),a.VM.SelectCounty="0",a.VM.SelectTown="0",a.VM.SelectVillage="0",a.VM.ResCountyAry=[{I:"0",N:"縣市"}].concat(ResCountydata),a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(ResTowndata),a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(ResVillagedata),a.VM.SelectResCounty="0",a.VM.SelectResTown="0",a.VM.SelectResVillage="0",a.changePage=function(b){$("#tmBlock").show();var c=a.PM.genPageData(b),d={};d.CaseID=$(".CaseID").html(),d=a.PM.filterPageData(c,d),a.PM.changePage("/CaseMaintain/UserProfileModifyListOP.aspx",d,function(b){a.TM.data=b.message,a.$apply(function(){})})},a.changePage(1),a.SelectResTownChange=function(){var b={};b.a="Village",b.p=$(".ResTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.ResVillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.ResVillageAry=[{I:"0",N:"村里"}],a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectResCountyChange=function(){var b={};b.a="Town",b.p=$(".ResCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.ResVillageAry=[{I:"0",N:"村里"}]):(a.VM.ResTownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.ResVillageAry=[{I:"0",N:"村里"}]),a.VM.SelectResTown="0",a.VM.SelectResVillage="0"})},1)}).fail(function(a,b){})},a.SelectConTownChange=function(){var b={};b.a="Village",b.p=$(".ConTown").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?a.VM.VillageAry=[{I:"0",N:"村里"}].concat(b):a.VM.VillageAry=[{I:"0",N:"村里"}],a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})},a.SelectConCountyChange=function(){var b={};b.a="Town",b.p=$(".ConCounty").val(),$.ajax({cache:!1,type:"POST",url:"/Ashx/SystemAreaCodeOP.ashx",data:b}).done(function(b){b=b||[],setTimeout(function(){a.$apply(function(){b.length>0?(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}].concat(b),a.VM.VillageAry=[{I:"0",N:"村里"}]):(a.VM.TownAry=[{I:"0",N:"鄉鎮市區"}],a.VM.VillageAry=[{I:"0",N:"村里"}]),a.VM.SelectTown="0",a.VM.SelectVillage="0"})},1)}).fail(function(a,b){})}}]);
//# sourceMappingURL=UserProfile.min.js.map