{"version":3,"sources":["AccountMaintain_Maintain.src.js"],"names":["$","document","on","e","history","go","preventDefault","show","angular","module","controller","$scope","TPM","$http","$filter","TM","VM","Uname","Oname","fList","fAry","iAry","i","forEach","item","index","obj","F","I","push","getCheck","record","rtn","each","checkAry","EV","C","EN","goDownload","$index","openWindowWithPost","goDelete","length","alert","postData","method","url","data","param","headers","Content-Type","success","status","config","FileCount","Chk","$apply","error"],"mappings":";;AAAAA,EAAE,WACEA,EAAEC,UAAUC,GAAG,QAAS,WAAY,SAAUC,GAG1C,MAFAC,SAAQC,GAAG,IACXF,EAAEG,kBACK,IAGXN,EAAE,YAAYO,SAIlBC,QAAQC,OAAO,SAAU,UAAU,UACzBC,WAAW,gBAAiB,SAAS,eAAgB,QAAS,UAAW,SAAUC,EAAOC,EAAKC,EAAOC,GAGnGH,EAAOI,MACPJ,EAAOK,MACPL,EAAOK,GAAGC,MAAQ,GAClBN,EAAOK,GAAGE,MAAQ,GAClBP,EAAOK,GAAGG,SAEVR,EAAOK,GAAGI,KAAOA,KACjBT,EAAOK,GAAGK,KAAOA,IAEjB,IAAIC,GAAI,CACRd,SAAQe,QAAQZ,EAAOK,GAAGI,KAAM,SAAUI,EAAMC,GAC5C,GAAIC,KACJA,GAAIC,EAAIH,EACRE,EAAIE,EAAIjB,EAAOK,GAAGK,KAAKC,GACvBX,EAAOK,GAAGG,MAAMU,KAAKH,GACrBJ,MAGJtB,EAAE,YAAYO,OAEdI,EAAOmB,SAAW,SAAUC,GACxB,GAAIC,GAAM,EAMV,OALAhC,GAAEiC,KAAKtB,EAAOK,GAAGkB,SAAU,SAAUT,EAAOD,GACpCA,EAAKW,IAAMJ,EAAOK,IAClBJ,EAAMR,EAAKa,MAGZL,GAGXrB,EAAO2B,WAAa,SAAUC,GAC1B,GAAIb,KACJA,GAAO,EAAIL,KAAKkB,GAChB3B,EAAI4B,mBAAmB,4DAA6D,SAAU,EAAG,EAAGd,IAGxGf,EAAO8B,SAAW,SAAUjB,EAAMC,GAE9B,GAAId,EAAOK,GAAGG,MAAMuB,QAAU,EAE1B,WADAC,OAAM,kBAIV,IAAIC,KACJA,GAAY,EAAIpB,EAAKI,EACrBgB,EAAa,GAAItB,EAEjBT,GACIgC,OAAQ,OACRC,IAAK,4DACLC,KAAM/C,EAAEgD,MAAMJ,GACdK,SAAWC,eAAgB,uCAE9BC,QAAQ,SAAUJ,EAAMK,EAAQH,EAASI,GACtCN,EAAKO,UAAYP,EAAKO,WAAa,EACnCP,EAAKQ,IAAMR,EAAKQ,KAAO,EACD,GAAlBR,EAAKO,UACLX,MAAM,YAEiB,GAAlBI,EAAKO,UACVX,MAAM,mBAGFI,EAAKQ,IAAM,GACXZ,MAAM,QACNhC,EAAOK,GAAGG,MAAQL,EAAQ,UAAUH,EAAOK,GAAGG,OAASS,EAAG,IAAMJ,EAAKI,IACrEjB,EAAO6C,OAAO,eAGdb,MAAM,UAIhBc,MAAM,SAAUV,EAAMK,EAAQH,EAASI","file":"AccountMaintain_Maintain.min.js","sourcesContent":["$(function () {\r\n    $(document).on(\"click\", \"#lastBtn\", function (e) {\r\n        history.go(-1);\r\n        e.preventDefault();\r\n        return false;\r\n    });\r\n\r\n    $(\"#tmBlock\").show();\r\n});\r\n\r\n\r\nangular.module(\"MyApp\", [\"FilterM\",\"ToolM\"])\r\n         .controller(\"MyController\", [\"$scope\",\"ToolProvider\" ,\"$http\", \"$filter\", function ($scope,TPM, $http, $filter) {\r\n\r\n            \r\n             $scope.TM = {};\r\n             $scope.VM = {};\r\n             $scope.VM.Uname = \"\";\r\n             $scope.VM.Oname = \"\";\r\n             $scope.VM.fList = [];\r\n\r\n             $scope.VM.fAry = fAry;\r\n             $scope.VM.iAry = iAry;\r\n\r\n             var i = 0;\r\n             angular.forEach($scope.VM.fAry, function (item, index) {\r\n                 var obj = {};\r\n                 obj.F = item;\r\n                 obj.I = $scope.VM.iAry[i];\r\n                 $scope.VM.fList.push(obj);\r\n                 i++;\r\n             });\r\n\r\n             $('#tmBlock').show();\r\n\r\n             $scope.getCheck = function (record) {\r\n                 var rtn = \"\";\r\n                 $.each($scope.VM.checkAry, function (index, item) {\r\n                     if (item.EV == record.C) {\r\n                         rtn = item.EN;\r\n                     }\r\n                 });\r\n                 return rtn;\r\n             };\r\n\r\n             $scope.goDownload = function ($index) {\r\n                 var obj = {};\r\n                 obj[\"i\"] = iAry[$index];\r\n                 TPM.openWindowWithPost(\"/System/AccountM/AccountMaintain_Maintain_DownloadOP.aspx\", \"_blank\", 0, 0, obj);\r\n             };\r\n\r\n             $scope.goDelete = function (item, index) {\r\n\r\n                 if ($scope.VM.fList.length <= 1) {\r\n                     alert(\"最少需要一個附檔，所以無法刪除\");\r\n                     return;\r\n                 }\r\n\r\n                 var postData = {};\r\n                 postData[\"i\"] = item.I;\r\n                 postData[\"ui\"] = i;\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/System/AccountM/AccountCheck_Detail_DeleteDocFileOP.aspx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                 .success(function (data, status, headers, config) {\r\n                     data.FileCount = data.FileCount || 0;\r\n                     data.Chk = data.Chk || 0;\r\n                     if (data.FileCount == 0) {\r\n                         alert(\"無附檔，刪除失敗\");\r\n                     }\r\n                     else if (data.FileCount == 1) {\r\n                         alert(\"最少需要一個附檔，所以無法刪除\");\r\n                     }\r\n                     else {\r\n                         if (data.Chk > 0) {\r\n                             alert(\"刪除成功\");\r\n                             $scope.VM.fList = $filter('filter')($scope.VM.fList, { I: '!' + item.I });\r\n                             $scope.$apply(function () { });\r\n                         }\r\n                         else {\r\n                             alert(\"刪除失敗\");\r\n                         }\r\n                     }\r\n                 })\r\n                  .error(function (data, status, headers, config) {\r\n                  });\r\n             };\r\n}]);\r\n\r\n"]}