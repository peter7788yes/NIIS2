/*! NIIS 2016-04-13 */

$(function(){var a=[],b=sessionStorage.getItem("leftMenuOrigin");if(b==data){var c=sessionStorage.getItem("leftMenu",data);$("#ulRoot").html(c),$("a").removeClass("here"),$("li").removeClass("hereblock")}else $.each(dataObj,function(b,c){if(""!=c.PageUrl&&a.push("x"+c.ID),0==c.PID)$("#ulRoot").append('<li id="x'+c.ID+'"><a href="javascript:void(0);" pageurl="'+c.PageUrl+'">'+c.ModuleName+"</a></li>");else{var d=$("#x"+c.PID+" ul");0==d.length&&$("#x"+c.PID).append('<ul class="line"></ul>'),$("#x"+c.PID+" ul:first").append('<li id="x'+c.ID+'"><a href="javascript:void(0);"  pageurl="'+c.PageUrl+'">'+c.ModuleName+"</a></li>")}}),$.each($("li"),function(a,b){0!=$(b).children("ul").length&&$(b).addClass("less")});$.each(a,function(a,b){$("#"+b).children("a:first").css("color","blue")}),sessionStorage.setItem("leftMenuOrigin",data),sessionStorage.setItem("leftMenu",$("#ulRoot").html()),$(document).on("click","a",function(a){var b=$(this),c=b.attr("pageurl");if(""!=c&&void 0!=c){var d="",e=$(this).parents("li");try{setTimeout(function(){0==moving&&(moving=!0,$("html, body").animate({scrollTop:b.offset().top-200},1e3,function(){moving=!1}))},0)}catch(a){}return $.each(e.get().reverse(),function(a,b){var c=$(b).children("a:first").attr("pageurl"),f=$(b).children("a:first").text(),g=""==c?"javascript:void(0);":c;d+=a!=e.length-1?'<a href="'+g+'">'+f+"</a>":f}),window.parent.document.getElementById("mainFrame").src=$(this).attr("pageurl"),$("a").removeClass("here"),$("li").removeClass("hereblock"),$(this).addClass("here"),$(this).parents("ul:first").parents("li:first").addClass("hereblock"),a.preventDefault(),!1}}),$(document).on("click",".add",function(a){return $(this).removeClass("add"),$(this).addClass("less"),$(this).children("ul:first").removeClass("hidden"),sessionStorage.setItem("leftMenu",$("#ulRoot").html()),a.preventDefault(),!1}),$(document).on("click",".less",function(a){return $(this).removeClass("less"),$(this).addClass("add"),$(this).children("ul:first").addClass("hidden"),sessionStorage.setItem("leftMenu",$("#ulRoot").html()),a.preventDefault(),!1}),""!=p&&$("a[pageurl='"+p+"']").trigger("click")});var moving=!1,changeMenuPath=function(a){a=a||"";var b=a.replace(/\//g,"").replace(/\./g,"").replace(/_/g,"").replace(/-/g,""),c=!1,d=!0;if($.each(dataObj,function(b,e){if(1==d&&a==e.PageUrl){c=!0;var f=$("#x"+e.ID).children("a:first"),g=$(f);$("a").removeClass("here"),$("li").removeClass("hereblock"),f.addClass("here"),f.parents("ul:first").parents("li:first").addClass("hereblock");try{setTimeout(function(){0==moving&&(moving=!0,$("html, body").animate({scrollTop:g.offset().top-200},1e3,function(){moving=!1}))},0)}catch(h){}var i="",j=f.parents("li");$.each(j.get().reverse(),function(a,b){var c=$(b).children("a:first").attr("pageurl"),d=$(b).children("a:first").text(),e=""==c?"javascript:void(0);":c;i+=a!=j.length-1?'<a href="'+e+'">'+d+"</a>":d});try{var k=window.parent.window.frames.mainFrame.window.document.getElementsByClassName("path")[0];i+='<img id="loading" alt="載入中..." src="/images/loading001.gif" style="display:none;margin-left:5px;" />',k.innerHTML=i,sessionStorage.setItem("menuPath",i),sessionStorage.setItem("menuPathID",e.ID)}catch(h){}d=!1}}),0==c){var e=sessionStorage.getItem("pathObjString");if(null!=e)try{var f=JSON.parse(e);if(void 0==f[b]){var g=sessionStorage.getItem("menuPath"),h=sessionStorage.getItem("menuPathID"),i=window.parent.window.frames.mainFrame.window.document.getElementsByClassName("path")[0];i.innerHTML=g,f[b]={},f[b].menuPath=g,f[b].menuPathID=h,sessionStorage.setItem("pathObjString",JSON.stringify(f))}else{var i=window.parent.window.frames.mainFrame.window.document.getElementsByClassName("path")[0];i.innerHTML=f[b].menuPath;var j=$("#x"+f[b].menuPathID).children("a:first");$("a").removeClass("here"),$("li").removeClass("hereblock"),j.addClass("here"),j.parents("ul:first").parents("li:first").addClass("hereblock");var k=$(j);try{setTimeout(function(){0==moving&&(moving=!0,$("html, body").animate({scrollTop:k.offset().top-200},1e3,function(){moving=!1}))},0)}catch(l){}}}catch(l){}else try{var f={},g=sessionStorage.getItem("menuPath"),h=sessionStorage.getItem("menuPathID"),i=window.parent.window.frames.mainFrame.window.document.getElementsByClassName("path")[0];i.innerHTML=g,f[b]={},f[b].menuPath=g,f[b].menuPathID=h,sessionStorage.setItem("pathObjString",JSON.stringify(f))}catch(l){}}};
//# sourceMappingURL=LeftMenu_tab.min.js.map