{"version":3,"sources":["UC_SelectAgency.src.js"],"names":["$","window","addEventListener","currentState","history","state","controllerElement","document","querySelector","controllerScope","angular","element","scope","$apply","changePage","pageIndex","location","search","length","setTimeout","go","module","controller","$scope","PageProvider","$http","hotkeys","PM","TM","VM","Vaccine","VaccineIDs","AN","CountyAry","I","N","TownAry","SelectCounty","SelectTown","BindCounty","postData","method","url","data","param","headers","Content-Type","success","status","config","concat","error","SelectCountyChange","val","show","tbData","message","pgData","genPageData","p","filterPageData","pushState","undefined","noHistory","hash","title","href","split","replaceState","add","combo","description","allowIn","callback","event","hotkey","focusType","activeElement","type","close","record","rtn","opener","getAgencyUC"],"mappings":"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","file":"UC_SelectAgency.min.js","sourcesContent":["$(function () {\r\n    window.addEventListener(\"popstate\", function () {\r\n        var currentState = history.state;\r\n        if (currentState !== null) {\r\n            var controllerElement = document.querySelector('section');\r\n            var controllerScope = angular.element(controllerElement).scope();\r\n            controllerScope.$apply(function () {\r\n                controllerScope.changePage(currentState.pageIndex, 1);\r\n            });\r\n        }\r\n    });\r\n\r\n    if (location.search.length > 0) {\r\n        setTimeout(function () {\r\n            history.go(-1);\r\n        }, 10);\r\n    }\r\n});\r\n\r\nangular.module(\"MyApp\", [\"PageM\", \"cfp.hotkeys\"])\r\n         .controller(\"MyController\", [\"$scope\", \"PageProvider\", \"$http\", \"hotkeys\", function ($scope, PageProvider, $http, hotkeys) {\r\n\r\n             $scope.PM = PageProvider;\r\n             $scope.TM = {};\r\n             $scope.VM = {};\r\n             $scope.VM.Vaccine = \"\";\r\n             $scope.VM.VaccineIDs = \"\";\r\n             $scope.VM.AN = \"\";\r\n\r\n             $scope.VM.CountyAry = [{ I: '0', N: \"全部\" }];\r\n             $scope.VM.TownAry = [{ I: '0', N: \"全部\" }];\r\n\r\n             $scope.VM.SelectCounty = \"0\";\r\n             $scope.VM.SelectTown = \"0\";\r\n\r\n\r\n             $scope.BindCounty = function () {\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"County\";\r\n\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                .success(function (data, status, headers, config) {\r\n                    data = data || [];\r\n                    if (data.length > 0) {\r\n                        $scope.VM.CountyAry = [].concat(data);\r\n                        $scope.VM.SelectCounty = \"0\";\r\n                    }\r\n                    else {\r\n                        $scope.VM.CountyAry = [];\r\n                        $scope.VM.SelectCounty = \"0\";\r\n                    }\r\n                })\r\n                .error(function (data, status, headers, config) {\r\n                    // called asynchronously if an error occurs\r\n                    // or server returns response with an error status.\r\n                });\r\n             };\r\n\r\n             $scope.BindCounty();\r\n\r\n\r\n\r\n             $scope.SelectCountyChange = function () {\r\n                 var postData = {};\r\n                 postData[\"a\"] = \"Town\";\r\n                 postData[\"p\"] = $(\"#SelectCounty\").val();\r\n\r\n                 $http({\r\n                     method: 'POST',\r\n                     url: \"/Ashx/SystemAreaCodeOP.ashx\",\r\n                     data: $.param(postData),\r\n                     headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\r\n                 })\r\n                .success(function (data, status, headers, config) {\r\n                    data = data || [];\r\n                    if (data.length > 0) {\r\n                        $scope.VM.TownAry = [].concat(data);;\r\n                        $scope.VM.SelectTown = \"0\";\r\n                    }\r\n                    else {\r\n                        $scope.VM.TownAry = [];\r\n                        $scope.VM.SelectTown = \"0\";\r\n                    }\r\n                })\r\n                .error(function (data, status, headers, config) {\r\n                    // called asynchronously if an error occurs\r\n                    // or server returns response with an error status.\r\n                });\r\n             };\r\n\r\n             $(\"#tmBlock\").show();\r\n             $scope.PM.changePage(\"\", tbData, function (data) {\r\n                 $scope.TM.data = data.message;\r\n                 //history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n             });\r\n             //$scope.changePage(1);\r\n             $scope.changePage = function (pageIndex) {\r\n                 //$(\"#pmBlock\").show();\r\n                 //$(\"#tmBlock\").show();\r\n\r\n                 var pgData = $scope.PM.genPageData(pageIndex);\r\n                 var postData = {};\r\n\r\n                 var postData = {};\r\n                 postData[\"an\"] = $scope.VM.AN;\r\n                 postData[\"ac\"] = $scope.VM.SelectCounty;\r\n                 postData[\"at\"] = $scope.VM.SelectTown;\r\n                 postData[\"p\"] = p;\r\n\r\n                 postData = $scope.PM.filterPageData(pgData, postData);\r\n\r\n                 $scope.PM.changePage(\"/UC/UC_SelectAgencyOP.aspx\", postData, function (data) {\r\n                     $scope.TM.data = data.message;\r\n                     $scope.$apply(function () { });\r\n\r\n                     if (history.pushState && noHistory == undefined) {\r\n                         if (pageIndex > 1 || location.hash.length > 0) {\r\n                             history.pushState({ \"pageIndex\": pageIndex }, document.title, location.href.split(\"?\")[0] + \"?#h\");\r\n                         }\r\n                         else {\r\n                             history.replaceState({ \"pageIndex\": 1 }, document.title, location.href);\r\n                         }\r\n                     }\r\n                 });\r\n\r\n             };\r\n\r\n             hotkeys.add({\r\n                 combo: 'enter',\r\n                 description: 'Description goes here',\r\n                 allowIn: ['INPUT', \"BUTTON\", 'SELECT', 'TEXTAREA'],\r\n                 callback: function (event, hotkey) {\r\n                     var focusType = document.activeElement.type;\r\n                     if (focusType == \"text\" || focusType == \"select-one\") {\r\n                         $scope.changePage(1);\r\n                     }\r\n                 }\r\n             });\r\n\r\n\r\n             $scope.close = function (record) {\r\n                 var rtn = {};\r\n                 rtn[\"I\"] = record.I;\r\n                 rtn[\"AN\"] = record.AN;\r\n                 window.opener.getAgencyUC(rtn);\r\n                 window.close();\r\n             };\r\n\r\n             var popUpWindow = function (url, title, w, h) {\r\n                 var left = (screen.width / 2) - (w / 2);\r\n                 var top = (screen.height / 2) - (h / 2);\r\n                 return window.open(url, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);\r\n             }\r\n\r\n\r\n             var openWindowWithPost = function (url, title, w, h, keys, values) {\r\n                 var newWindow = popUpWindow(url, title, w, h);\r\n                 if (!newWindow) return false;\r\n                 var html = \"\";\r\n                 html += \"<html><head></head><body><form id='formid' method='post' action='\" + url + \"' autocomplete='off'>\";\r\n                 keys = keys || [];\r\n                 values = values || [];\r\n                 if (keys && values && (keys.length == values.length))\r\n                     for (var i = 0; i < keys.length; i++)\r\n                         html += \"<input type='hidden' name='\" + keys[i] + \"' value='\" + values[i] + \"'/>\";\r\n                 html += \"</form><script>document.getElementById('formid').submit();\" + \"</\" + \"script\" + \"></\" + \"body\" + \"></\" + \"html>\";\r\n                 newWindow.document.write(html);\r\n                 return newWindow;\r\n             }\r\n}]);\r\n\r\n\r\n"]}